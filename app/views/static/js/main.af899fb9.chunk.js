(this["webpackJsonpsphc-map-react"]=this["webpackJsonpsphc-map-react"]||[]).push([[0],{164:function(e,t,n){},321:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),o=n(52),i=n.n(o),c=n(27),r=n(9),l=n(10),d=n(3),u=n(11),h=n(13),b=n(19),j=(n(164),n(37)),g=n.n(j),m=g.a.create({baseURL:"https://map.savepublichousing.com/api/",headers:{"Content-type":"application/json"}});function p(){var e=JSON.parse(localStorage.getItem("user"));return e&&e.accessToken?{"x-access-token":e.accessToken}:{}}var O=new(function(){function e(){Object(r.a)(this,e)}return Object(l.a)(e,[{key:"getAll",value:function(){return m.get("/locations",{headers:p()})}},{key:"getPublished",value:function(){return m.get("/locations/published",{headers:p()})}},{key:"getSinglePublished",value:function(e){return m.get("/locations/published/".concat(e),{headers:p()})}},{key:"get",value:function(e){return m.get("/locations/".concat(e),{headers:p()})}},{key:"create",value:function(e){return m.post("/locations",e,{headers:p()})}},{key:"update",value:function(e,t){return m.put("/locations/".concat(e),t,{headers:p()})}},{key:"delete",value:function(e){return m.delete("/locations/".concat(e),{headers:p()})}},{key:"deleteAll",value:function(){return m.delete("/locations",{headers:p()})}},{key:"findByTitle",value:function(e){return m.get("/locations?title=".concat(e),{headers:p()})}},{key:"findBySlug",value:function(e){return m.get("/locations/slug/".concat(e),{headers:p()})}},{key:"findByAuthor",value:function(e){return m.get("/locations/author/".concat(e),{headers:p()})}}]),e}()),v="https://map.savepublichousing.com/api/auth/",f=new(function(){function e(){Object(r.a)(this,e)}return Object(l.a)(e,[{key:"login",value:function(e,t){return g.a.post(v+"signin",{email:e,password:t}).then((function(e){return e.data.accessToken&&localStorage.setItem("user",JSON.stringify(e.data)),e.data}))}},{key:"logout",value:function(){localStorage.removeItem("user")}},{key:"register",value:function(e,t,n){return g.a.post(v+"signup",{username:e,email:t,password:n})}},{key:"getCurrentUser",value:function(){return JSON.parse(localStorage.getItem("user"))}},{key:"requestToken",value:function(e){return g.a.post(v+"request-token",{email:e}).then((function(e){return e.data}))}},{key:"checkToken",value:function(e,t){return g.a.post(v+"check-token",{id:e,token:t}).then((function(e){return e.data}))}},{key:"resetPassword",value:function(e,t,n,a){return g.a.post(v+"reset-password",{email:e,token:t,id:n,password:a}).then((function(e){return e.data}))}}]),e}()),x=n(0),y=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).onChangeTitle=a.onChangeTitle.bind(Object(d.a)(a)),a.onChangeDescription=a.onChangeDescription.bind(Object(d.a)(a)),a.saveLocation=a.saveLocation.bind(Object(d.a)(a)),a.newLocation=a.newLocation.bind(Object(d.a)(a)),a.state={id:null,title:"",description:"",published:!1,submitted:!1,loggedInUser:null,isLoggedIn:!1,isMod:!1,isAdmin:!1},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=f.getCurrentUser();e&&this.setState({loggedInUser:e.id,isLoggedIn:!0,isMod:e.roles.includes("ROLE_MODERATOR"),isAdmin:e.roles.includes("ROLE_ADMIN")})}},{key:"onChangeTitle",value:function(e){this.setState({title:e.target.value})}},{key:"onChangeDescription",value:function(e){this.setState({description:e.target.value})}},{key:"saveLocation",value:function(){var e=this,t={title:this.state.title,description:this.state.description,authorId:this.state.loggedInUser};O.create(t).then((function(t){e.setState({id:t.data.id,title:t.data.title,description:t.data.description,published:t.data.published,submitted:!0})})).catch((function(e){console.log(e)}))}},{key:"newLocation",value:function(){this.setState({id:null,title:"",description:"",published:!1,submitted:!1})}},{key:"render",value:function(){return Object(x.jsx)("div",{className:"submit-form",children:this.state.submitted?Object(x.jsxs)("div",{children:[Object(x.jsx)("h4",{children:"You submitted successfully!"}),Object(x.jsx)("a",{className:"btn",href:"/admin/locations/"+this.state.id,children:"Edit location"}),Object(x.jsx)("button",{className:"btn btn-success",onClick:this.newLocation,children:"Add another location"})]}):Object(x.jsxs)("div",{children:[Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"title",children:"Title"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"title",required:!0,value:this.state.title,onChange:this.onChangeTitle,name:"title"})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"description",children:"Description"}),Object(x.jsx)("p",{className:"small",children:"Describe the location in one sentence. This will be shown on the map pop ups."}),Object(x.jsx)("textarea",{type:"text",className:"form-control",id:"description",required:!0,value:this.state.description,onChange:this.onChangeDescription,name:"description"})]}),Object(x.jsx)("button",{onClick:this.saveLocation,className:"btn btn-success",children:"Submit"})]})})}}]),n}(a.Component),C=n(2),k=new(function(){function e(){Object(r.a)(this,e)}return Object(l.a)(e,[{key:"getAll",value:function(){return m.get("/users",{headers:p()})}},{key:"get",value:function(e){return m.get("/users/".concat(e),{headers:p()})}},{key:"create",value:function(e){return m.post("/users",e,{headers:p()})}},{key:"update",value:function(e,t){return m.put("/users/".concat(e),t,{headers:p()})}},{key:"delete",value:function(e){return m.delete("/users/".concat(e),{headers:p()})}},{key:"deleteAll",value:function(){return m.delete("/users",{headers:p()})}},{key:"findByUsername",value:function(e){return m.get("/users?username=".concat(e),{headers:p()})}}]),e}()),N=new(function(){function e(){Object(r.a)(this,e)}return Object(l.a)(e,[{key:"getAll",value:function(){return m.get("/categories",{headers:p()})}},{key:"get",value:function(e){return m.get("/categories/".concat(e),{headers:p()})}},{key:"create",value:function(e){return m.post("/categories",e,{headers:p()})}},{key:"update",value:function(e,t){return m.put("/categories/".concat(e),t,{headers:p()})}},{key:"delete",value:function(e){return m.delete("/categories/".concat(e),{headers:p()})}}]),e}()),w=n(22),L=n(121),_=n(157),S=n(105),U=(n(114),n(115),function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).setLink=a.setLink.bind(Object(d.a)(a)),console.log(S.a),S.a.options.openOnClick=!1,a.state={editor:new L.a({content:{type:"doc",content:[]},extensions:[].concat(Object(w.a)(Object(_.a)()),[S.a])})},a.state.editor.on("update",(function(e){e.editor;a.props.onChange(a.state.editor.getHTML())})),a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.state.editor.commands.setContent(this.props.content)}},{key:"componentDidUpdate",value:function(e,t,n){this.props.content!==e.content&&this.props.content!==this.state.editor.getHTML()&&this.state.editor.commands.setContent(this.props.content)}},{key:"setLink",value:function(){console.log("set link");var e=window.prompt("URL");console.log(this.state),this.state.editor.chain().focus().setLink({href:e,target:"_blank"}).run()}},{key:"render",value:function(){return Object(x.jsxs)("div",{children:[Object(x.jsx)(I,{editor:this.state.editor,setLink:this.setLink}),Object(x.jsx)(L.b,{editor:this.state.editor})]})}}]),n}(a.Component)),I=function(e){var t=e.editor,n=e.setLink;return t?Object(x.jsxs)("div",{className:"prosemirror-menu btn-group",children:[Object(x.jsxs)("button",{type:"button",title:"Bold",onClick:function(){return t.chain().focus().toggleBold().run()},className:t.isActive("bold")?"btn btn-secondary":"btn  btn-secondary",children:[Object(x.jsx)("img",{src:"/icons/bold.svg"}),Object(x.jsx)("span",{className:"sr-only",children:"bold"})]}),Object(x.jsxs)("button",{type:"button",title:"Italic",onClick:function(){return t.chain().focus().toggleItalic().run()},className:t.isActive("italic")?"btn btn-secondary":"btn  btn-secondary",children:[Object(x.jsx)("img",{src:"/icons/italic.svg"}),Object(x.jsx)("span",{className:"sr-only",children:"italic"})]}),Object(x.jsxs)("button",{type:"button",title:"Strikethrough",onClick:function(){return t.chain().focus().toggleStrike().run()},className:t.isActive("strike")?"btn btn-secondary":"btn  btn-secondary",children:[Object(x.jsx)("img",{src:"/icons/strike.svg"}),Object(x.jsx)("span",{className:"sr-only",children:"strike"})]}),Object(x.jsxs)("button",{type:"button",title:"Add link",onClick:function(){return n()},className:t.isActive("link")?"btn btn-secondary":"btn  btn-secondary",children:[Object(x.jsx)("img",{src:"/icons/link.svg"}),Object(x.jsx)("span",{className:"sr-only",children:"Add link"})]}),Object(x.jsxs)("button",{type:"button",title:"Remove link",onClick:function(){return t.chain().focus().unsetLink().run()},className:t.isActive("link")?"btn btn-secondary":"btn  btn-secondary",children:[Object(x.jsx)("img",{src:"/icons/unlink.svg"}),Object(x.jsx)("span",{className:"sr-only",children:"Remove link"})]}),Object(x.jsxs)("button",{type:"button",title:"Heading",onClick:function(){return t.chain().focus().toggleHeading({level:3}).run()},className:t.isActive("heading",{level:3})?"btn btn-secondary":"btn  btn-secondary",children:["H",Object(x.jsx)("span",{className:"sr-only",children:"heading"})]}),Object(x.jsxs)("button",{type:"button",title:"Bullet list",onClick:function(){return t.chain().focus().toggleBulletList().run()},className:t.isActive("bulletList")?"btn btn-secondary":"btn  btn-secondary",children:[Object(x.jsx)("img",{src:"/icons/ul.svg"}),Object(x.jsx)("span",{className:"sr-only",children:"bullet list"})]}),Object(x.jsxs)("button",{title:"Numbered list",type:"button",onClick:function(){return t.chain().focus().toggleOrderedList().run()},className:t.isActive("orderedList")?"btn btn-secondary":"btn  btn-secondary",children:[Object(x.jsx)("img",{src:"/icons/ol.svg"}),Object(x.jsx)("span",{className:"sr-only",children:"numbered list"})]}),Object(x.jsxs)("button",{type:"button",title:"Undo",className:"btn btn-secondary",onClick:function(){return t.chain().focus().undo().run()},children:[Object(x.jsx)("img",{src:"/icons/undo.svg"}),Object(x.jsx)("span",{className:"sr-only",children:"undo"})]}),Object(x.jsxs)("button",{type:"button",title:"Redo",className:"btn btn-secondary",onClick:function(){return t.chain().focus().redo().run()},children:[Object(x.jsx)("img",{src:"/icons/redo.svg"}),Object(x.jsx)("span",{className:"sr-only",children:"redo"})]}),Object(x.jsxs)("button",{type:"button",title:"Clear formatting",className:"btn btn-secondary",onClick:function(){return t.chain().focus().unsetAllMarks().clearNodes().run()},children:[Object(x.jsx)("img",{src:"/icons/remove.svg"}),Object(x.jsx)("span",{className:"sr-only",children:"clear formatting"})]})]}):null},A=new(function(){function e(){Object(r.a)(this,e)}return Object(l.a)(e,[{key:"getAll",value:function(){return m.get("/images",{headers:p()})}},{key:"get",value:function(e){return m.get("/images/".concat(e),{headers:p()})}},{key:"create",value:function(e){return m.post("/images",e,{headers:p()})}},{key:"update",value:function(e,t){return m.put("/images/".concat(e),t,{headers:p()})}},{key:"delete",value:function(e){return m.delete("/images/".concat(e),{headers:p()})}},{key:"findByLocation",value:function(e){return m.get("/images/location/".concat(e),{headers:p()})}}]),e}()),R=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).onRemove=a.onRemove.bind(Object(d.a)(a)),a.onUpdate=a.onUpdate.bind(Object(d.a)(a)),a.onUpload=a.onUpload.bind(Object(d.a)(a)),a.onChangeCaption=a.onChangeCaption.bind(Object(d.a)(a)),a.onChangeCopyright=a.onChangeCopyright.bind(Object(d.a)(a)),a.onChangeNewCaption=a.onChangeNewCaption.bind(Object(d.a)(a)),a.onChangeNewCopyright=a.onChangeNewCopyright.bind(Object(d.a)(a)),a.onChangeFile=a.onChangeFile.bind(Object(d.a)(a)),a.getImages=a.getImages.bind(Object(d.a)(a)),a.state={images:[],newImage:{copyright:"",caption:"",file:null}},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.getImages(this.props.location)}},{key:"componentDidUpdate",value:function(e,t,n){this.props.location!==e.location&&this.getImages(this.props.location)}},{key:"getImages",value:function(e,t){var n=this;e&&A.findByLocation(e).then((function(e){n.setState({images:e.data}),console.log(e.data),"function"===typeof t&&t()})).catch((function(e){console.log(e)}))}},{key:"onChangeNewCopyright",value:function(e){this.setState((function(t){return{newImage:Object(C.a)(Object(C.a)({},t.newImage),{},{copyright:e.target.value})}}))}},{key:"onChangeNewCaption",value:function(e){this.setState((function(t){return{newImage:Object(C.a)(Object(C.a)({},t.newImage),{},{caption:e.target.value})}}))}},{key:"onChangeFile",value:function(e){this.setState((function(t){return{newImage:Object(C.a)(Object(C.a)({},t.newImage),{},{file:e.target.files[0]})}}))}},{key:"onChangeCaption",value:function(e,t){var n=this.state.images.map((function(n){return n.id===e?Object(C.a)(Object(C.a)({},n),{},{caption:t.target.value}):n}));this.setState({images:n})}},{key:"onChangeCopyright",value:function(e,t){var n=this.state.images.map((function(n){return n.id===e?Object(C.a)(Object(C.a)({},n),{},{copyright:t.target.value}):n}));this.setState({images:n})}},{key:"onUpload",value:function(){var e=this;if(null!==this.state.newImage.file){var t=new FormData;t.append("caption",this.state.newImage.caption),t.append("copyright",this.state.newImage.copyright),t.append("locationId",this.props.location),t.append("file",this.state.newImage.file),t.append("name",this.state.newImage.file.name),A.create(t).then((function(t){e.setState({newImage:{copyright:"",caption:"",file:null}}),document.getElementById("new-image-file").value="",e.getImages(e.props.location)})).catch((function(e){console.log(e)}))}else alert("Please select a file to upload.")}},{key:"onRemove",value:function(e){var t=this;window.confirm("Are you sure you want to delete this image?")&&A.delete(e).then((function(e){t.getImages(t.props.location)})).catch((function(e){console.log(e)}))}},{key:"onUpdate",value:function(e){var t=this,n=this.state.images.find((function(t){return t.id===e}));A.update(e,n).then((function(n){t.getImages(t.props.location,(function(){var n=t.state.images.map((function(t){return t.id===e?Object(C.a)(Object(C.a)({},t),{},{status:"Updated successfully"}):t}));t.setState({images:n})}))})).catch((function(n){console.log(n);var a=t.state.images.map((function(t){return t.id===e?Object(C.a)(Object(C.a)({},t),{},{status:"Unable to update image."}):t}));t.setState({images:a})}))}},{key:"render",value:function(){var e=this;return Object(x.jsxs)("div",{className:"location-library",children:[Object(x.jsx)("h2",{children:"Images"}),Object(x.jsx)("ul",{children:this.state.images&&this.state.images.length>0&&this.state.images.map((function(t){return Object(x.jsx)("li",{children:Object(x.jsxs)("div",{className:"card",children:[Object(x.jsxs)("div",{className:"card-body",children:[e.props.lead_image==t.id&&Object(x.jsx)("span",{className:"lead-image",children:"Lead image"}),Object(x.jsx)("img",{src:t.url,style:{maxHeight:"200px",maxWidth:"200px",display:"block"}}),Object(x.jsx)("label",{htmlFor:"caption-"+t.id,children:"Caption"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"caption-"+t.id,value:t.caption,onChange:function(n){return e.onChangeCaption(t.id,n)}}),Object(x.jsx)("label",{htmlFor:"copyright-"+t.id,children:"Copyright"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"copyright-"+t.id,value:t.copyright,onChange:function(n){return e.onChangeCopyright(t.id,n)}})]}),Object(x.jsxs)("div",{className:"card-footer",children:[Object(x.jsx)("button",{type:"button",onClick:function(){return e.onUpdate(t.id)},className:"btn btn-success",children:"Update"}),Object(x.jsx)("button",{type:"button",onClick:function(){return e.onRemove(t.id)},className:"btn btn-danger",children:"Remove"}),e.props.lead_image!==t.id&&Object(x.jsx)("button",{type:"button",onClick:function(){return e.props.onSetLeadImage(t.id)},className:"btn btn-primary",children:"Set as lead image"}),Object(x.jsx)("div",{className:"status",children:t.status})]})]})},t.id)}))}),Object(x.jsx)("div",{className:"card",children:Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("h4",{className:"card-title",children:"Add new image"}),Object(x.jsx)("label",{htmlFor:"new-image-file",children:"Image"}),Object(x.jsx)("input",{type:"file",className:"form-control",id:"new-image-file",onChange:this.onChangeFile}),Object(x.jsx)("label",{htmlFor:"new-caption",children:"Caption"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"new-caption",value:this.state.newImage.caption,onChange:this.onChangeNewCaption}),Object(x.jsx)("label",{htmlFor:"new-copyright",children:"Copyright"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"new-copyright",value:this.state.newImage.copyright,onChange:this.onChangeNewCopyright}),Object(x.jsx)("button",{type:"button",value:"Upload",onClick:this.onUpload,className:"btn btn-primary",children:"Upload"})]})})]})}}]),n}(a.Component),T=new(function(){function e(){Object(r.a)(this,e)}return Object(l.a)(e,[{key:"getAll",value:function(){return m.get("/residents",{headers:p()})}},{key:"get",value:function(e){return m.get("/residents/".concat(e),{headers:p()})}},{key:"create",value:function(e){return m.post("/residents",e,{headers:p()})}},{key:"update",value:function(e,t){return m.put("/residents/".concat(e),t,{headers:p()})}},{key:"delete",value:function(e){return m.delete("/residents/".concat(e),{headers:p()})}},{key:"findByLocation",value:function(e){return m.get("/residents/location/".concat(e),{headers:p()})}}]),e}()),F=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).getResidents=a.getResidents.bind(Object(d.a)(a)),a.onChangeName=a.onChangeName.bind(Object(d.a)(a)),a.onChangeStory=a.onChangeStory.bind(Object(d.a)(a)),a.onRemove=a.onRemove.bind(Object(d.a)(a)),a.onUpdate=a.onUpdate.bind(Object(d.a)(a)),a.onChangeNewName=a.onChangeNewName.bind(Object(d.a)(a)),a.onChangeNewStory=a.onChangeNewStory.bind(Object(d.a)(a)),a.onUpload=a.onUpload.bind(Object(d.a)(a)),a.state={residents:[],newResident:{name:"",story:""}},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.getResidents(this.props.location)}},{key:"componentDidUpdate",value:function(e,t,n){this.props.location!==e.location&&this.getResidents(this.props.location)}},{key:"getResidents",value:function(e,t){var n=this;e&&T.findByLocation(e).then((function(e){n.setState({residents:e.data}),console.log(e.data),"function"===typeof t&&t()})).catch((function(e){console.log(e)}))}},{key:"onChangeName",value:function(e,t){var n=this.state.residents.map((function(n){return n.id===e?Object(C.a)(Object(C.a)({},n),{},{name:t.target.value}):n}));this.setState({residents:n})}},{key:"onChangeStory",value:function(e,t){var n=this.state.residents.map((function(n){return n.id===e?Object(C.a)(Object(C.a)({},n),{},{story:t.target.value}):n}));this.setState({residents:n})}},{key:"onRemove",value:function(e){var t=this;window.confirm("Are you sure you want to delete this story?")&&T.delete(e).then((function(e){t.getResidents(t.props.location)})).catch((function(e){console.log(e)}))}},{key:"onUpdate",value:function(e){var t=this,n=this.state.residents.find((function(t){return t.id===e}));T.update(e,n).then((function(n){t.getResidents(t.props.location,(function(){var n=t.state.residents.map((function(t){return t.id===e?Object(C.a)(Object(C.a)({},t),{},{status:"Updated successfully"}):t}));t.setState({residents:n})}))})).catch((function(n){console.log(n);var a=t.state.residents.map((function(t){return t.id===e?Object(C.a)(Object(C.a)({},t),{},{status:"Update unsuccessful"}):t}));t.setState({residents:a})}))}},{key:"onChangeNewName",value:function(e){this.setState((function(t){return{newResident:Object(C.a)(Object(C.a)({},t.newResident),{},{name:e.target.value})}}))}},{key:"onChangeNewStory",value:function(e){this.setState((function(t){return{newResident:Object(C.a)(Object(C.a)({},t.newResident),{},{story:e.target.value})}}))}},{key:"onUpload",value:function(){var e=this,t={name:this.state.newResident.name,story:this.state.newResident.story,locationId:this.props.location};T.create(t).then((function(t){e.setState({newResident:{name:"",story:""}}),e.getResidents(e.props.location)})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this;return Object(x.jsxs)("div",{className:"location-library",children:[Object(x.jsx)("h2",{children:"Resident Stories"}),Object(x.jsx)("ul",{children:this.state.residents&&this.state.residents.length>0&&this.state.residents.map((function(t){return Object(x.jsx)("li",{children:Object(x.jsxs)("div",{className:"card",children:[Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("label",{htmlFor:"name-"+t.id,children:"Name"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"name-"+t.id,value:t.name,onChange:function(n){return e.onChangeName(t.id,n)}}),Object(x.jsx)("label",{htmlFor:"story-"+t.id,children:"Story"}),Object(x.jsx)("textarea",{className:"form-control paragraphs",id:"story-"+t.id,value:t.story,onChange:function(n){return e.onChangeStory(t.id,n)}})]}),Object(x.jsxs)("div",{className:"card-footer",children:[Object(x.jsx)("button",{type:"button",onClick:function(){return e.onUpdate(t.id)},className:"btn btn-success",children:"Update"}),Object(x.jsx)("button",{type:"button",onClick:function(){return e.onRemove(t.id)},className:"btn btn-danger",children:"Remove"}),Object(x.jsx)("div",{className:"status",children:t.status})]})]})},t.id)}))}),Object(x.jsx)("div",{className:"card",children:Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("h4",{className:"card-title",children:"Add new resident story"}),Object(x.jsx)("label",{htmlFor:"new-name",children:"Name"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"new-name",value:this.state.newResident.name,onChange:this.onChangeNewName}),Object(x.jsx)("label",{htmlFor:"new-story",children:"Story"}),Object(x.jsx)("textarea",{className:"form-control paragraphs",id:"new-story",value:this.state.newResident.story,onChange:this.onChangeNewStory}),Object(x.jsx)("button",{type:"button",value:"Upload",onClick:this.onUpload,className:"btn btn-primary",children:"Upload"})]})})]})}}]),n}(a.Component),D=n(93),M=n.n(D),P=(n(130),new(function(){function e(){Object(r.a)(this,e)}return Object(l.a)(e,[{key:"getAll",value:function(){return m.get("/resources",{headers:p()})}},{key:"get",value:function(e){return m.get("/resources/".concat(e),{headers:p()})}},{key:"create",value:function(e){return m.post("/resources",e,{headers:p()})}},{key:"update",value:function(e,t){return m.put("/resources/".concat(e),t,{headers:p()})}},{key:"delete",value:function(e){return m.delete("/resources/".concat(e),{headers:p()})}},{key:"findByLocation",value:function(e){return m.get("/resources/location/".concat(e),{headers:p()})}}]),e}())),E=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).onRemove=a.onRemove.bind(Object(d.a)(a)),a.onUpdate=a.onUpdate.bind(Object(d.a)(a)),a.onUpload=a.onUpload.bind(Object(d.a)(a)),a.onChangeName=a.onChangeName.bind(Object(d.a)(a)),a.onChangeDescription=a.onChangeDescription.bind(Object(d.a)(a)),a.onChangeNewName=a.onChangeNewName.bind(Object(d.a)(a)),a.onChangeURL=a.onChangeURL.bind(Object(d.a)(a)),a.onChangeNewDescription=a.onChangeNewDescription.bind(Object(d.a)(a)),a.onChangeFile=a.onChangeFile.bind(Object(d.a)(a)),a.onToggleIsFile=a.onToggleIsFile.bind(Object(d.a)(a)),a.getResources=a.getResources.bind(Object(d.a)(a)),a.state={resources:[],newResource:{name:"",description:"",file:null,url:"",isFile:!0}},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.getResources(this.props.location)}},{key:"componentDidUpdate",value:function(e,t,n){this.props.location!==e.location&&this.getResources(this.props.location)}},{key:"getResources",value:function(e,t){var n=this;e&&P.findByLocation(e).then((function(e){n.setState({resources:e.data}),console.log(e.data),"function"===typeof t&&t()})).catch((function(e){console.log(e)}))}},{key:"onToggleIsFile",value:function(e){this.setState((function(t){return{newResource:Object(C.a)(Object(C.a)({},t.newResource),{},{isFile:e.target.checked,url:"",file:null})}}))}},{key:"onChangeURL",value:function(e){this.setState((function(t){return{newResource:Object(C.a)(Object(C.a)({},t.newResource),{},{url:e.target.value})}}))}},{key:"onChangeNewName",value:function(e){this.setState((function(t){return{newResource:Object(C.a)(Object(C.a)({},t.newResource),{},{name:e.target.value})}}))}},{key:"onChangeNewDescription",value:function(e){this.setState((function(t){return{newResource:Object(C.a)(Object(C.a)({},t.newResource),{},{description:e.target.value})}}))}},{key:"onChangeFile",value:function(e){this.setState((function(t){return{newResource:Object(C.a)(Object(C.a)({},t.newResource),{},{file:e.target.files[0]})}}))}},{key:"onChangeName",value:function(e,t){var n=this.state.resources.map((function(n){return n.id===e?Object(C.a)(Object(C.a)({},n),{},{name:t.target.value}):n}));this.setState({resources:n})}},{key:"onChangeDescription",value:function(e,t){var n=this.state.resources.map((function(n){return n.id===e?Object(C.a)(Object(C.a)({},n),{},{description:t.target.value}):n}));this.setState({resources:n})}},{key:"onUpload",value:function(){var e=this,t=new FormData;t.append("name",this.state.newResource.name),t.append("description",this.state.newResource.description),t.append("url",this.state.newResource.url),t.append("locationId",this.props.location),t.append("file",this.state.newResource.file),P.create(t).then((function(t){e.setState({newResource:{name:"",description:"",url:"",file:null,isFile:!0}}),document.getElementById("new-resource-file").value="",e.getResources(e.props.location)})).catch((function(e){console.log(e)}))}},{key:"onRemove",value:function(e){var t=this;window.confirm("Are you sure you want to delete this resource?")&&P.delete(e).then((function(e){t.getResources(t.props.location)})).catch((function(e){console.log(e)}))}},{key:"onUpdate",value:function(e){var t=this,n=this.state.resources.find((function(t){return t.id===e}));P.update(e,n).then((function(n){t.getResources(t.props.location,(function(){var n=t.state.resources.map((function(t){return t.id===e?Object(C.a)(Object(C.a)({},t),{},{status:"Updated successfully"}):t}));t.setState({resources:n})}))})).catch((function(n){console.log(n);var a=t.state.resources.map((function(t){return t.id===e?Object(C.a)(Object(C.a)({},t),{},{status:"Update unsuccessful"}):t}));t.setState({resources:a})}))}},{key:"render",value:function(){var e=this;return Object(x.jsxs)("div",{className:"location-library",children:[Object(x.jsx)("h2",{children:"Resources"}),Object(x.jsx)("ul",{children:this.state.resources&&this.state.resources.length>0&&this.state.resources.map((function(t){return Object(x.jsx)("li",{children:Object(x.jsxs)("div",{className:"card",children:[Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("p",{children:Object(x.jsx)("a",{href:t.url,target:"_blank",children:t.url})}),Object(x.jsx)("label",{htmlFor:"name-"+t.id,children:"Name"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"name-"+t.id,value:t.name,onChange:function(n){return e.onChangeName(t.id,n)}}),Object(x.jsx)("label",{htmlFor:"description-"+t.id,children:"Description"}),Object(x.jsx)("textarea",{className:"form-control paragraphs",id:"description-"+t.id,value:t.description,onChange:function(n){return e.onChangeDescription(t.id,n)}})]}),Object(x.jsxs)("div",{className:"card-footer",children:[Object(x.jsx)("button",{type:"button",onClick:function(){return e.onUpdate(t.id)},className:"btn btn-success",children:"Update"}),Object(x.jsx)("button",{type:"button",onClick:function(){return e.onRemove(t.id)},className:"btn btn-danger",children:"Remove"}),Object(x.jsx)("div",{className:"status",children:t.status})]})]})},t.id)}))}),Object(x.jsx)("div",{className:"card",children:Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("h4",{className:"card-title",children:"Add new resource"}),Object(x.jsx)("span",{className:this.state.newResource.isFile?"file-toggle-label":"file-toggle-label file-toggle-label-active",children:"URL"}),Object(x.jsx)(M.a,{id:"is-file",checked:this.state.newResource.isFile,onChange:this.onToggleIsFile}),Object(x.jsx)("span",{className:this.state.newResource.isFile?" file-toggle-label file-toggle-label-active":"file-toggle-label",children:"File"}),Object(x.jsx)("label",{htmlFor:"is-file",className:"sr-only",children:"File or URL"}),this.state.newResource.isFile&&Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"new-resource-file",children:"File"}),Object(x.jsx)("input",{type:"file",className:"form-control",id:"new-resource-file",onChange:this.onChangeFile})]}),!this.state.newResource.isFile&&Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"new-url",children:"URL"}),Object(x.jsx)("input",{type:"url",className:"form-control",id:"new-url",onChange:this.onChangeURL})]}),Object(x.jsx)("label",{htmlFor:"new-name",children:"Name"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"new-name",value:this.state.newResource.name,onChange:this.onChangeNewName}),Object(x.jsx)("label",{htmlFor:"new-copyright",children:"Description"}),Object(x.jsx)("textarea",{className:"form-control paragraphs",id:"new-description",value:this.state.newResource.description,onChange:this.onChangeNewDescription}),Object(x.jsx)("button",{type:"button",value:"Upload",onClick:this.onUpload,className:"btn btn-primary",children:"Upload"})]})})]})}}]),n}(a.Component),B=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).onChangeTitle=a.onChangeTitle.bind(Object(d.a)(a)),a.onChangeSlug=a.onChangeSlug.bind(Object(d.a)(a)),a.onChangeDescription=a.onChangeDescription.bind(Object(d.a)(a)),a.onChangeIntroduction=a.onChangeIntroduction.bind(Object(d.a)(a)),a.onChangeHistory=a.onChangeHistory.bind(Object(d.a)(a)),a.onChangeYoutube=a.onChangeYoutube.bind(Object(d.a)(a)),a.onChangeCallToActionText=a.onChangeCallToActionText.bind(Object(d.a)(a)),a.onChangeCallToActionLink=a.onChangeCallToActionLink.bind(Object(d.a)(a)),a.onChangeCallToActionButton=a.onChangeCallToActionButton.bind(Object(d.a)(a)),a.onChangeAuthorId=a.onChangeAuthorId.bind(Object(d.a)(a)),a.onChangeCategoryId=a.onChangeCategoryId.bind(Object(d.a)(a)),a.getLocation=a.getLocation.bind(Object(d.a)(a)),a.onChangeLatitude=a.onChangeLatitude.bind(Object(d.a)(a)),a.onChangeLongitude=a.onChangeLongitude.bind(Object(d.a)(a)),a.onSetLeadImage=a.onSetLeadImage.bind(Object(d.a)(a)),a.getAuthor=a.getAuthor.bind(Object(d.a)(a)),a.getAllAuthors=a.getAllAuthors.bind(Object(d.a)(a)),a.getAllCategories=a.getAllCategories.bind(Object(d.a)(a)),a.updatePublished=a.updatePublished.bind(Object(d.a)(a)),a.updateLocation=a.updateLocation.bind(Object(d.a)(a)),a.deleteLocation=a.deleteLocation.bind(Object(d.a)(a)),a.state={currentLocation:{id:null,title:"",slug:"",description:"",published:!1,authorId:null,latitude:null,longitude:null,introduction:"",history:"",lead_image:null,categoryId:null,call_to_action_text:"",call_to_action_link:"",call_to_action_button:""},message:"",messageClass:"",loggedInUser:null,isLoggedIn:!1,isMod:!1,isAdmin:!1,allAuthors:[],allCategories:[]},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=f.getCurrentUser();e&&this.setState({loggedInUser:e.id,isLoggedIn:!0,isMod:e.roles.includes("ROLE_MODERATOR"),isAdmin:e.roles.includes("ROLE_ADMIN")}),this.getLocation(this.props.match.params.id),this.getAllCategories()}},{key:"onChangeTitle",value:function(e){var t=e.target.value;this.setState((function(e){return{currentLocation:Object(C.a)(Object(C.a)({},e.currentLocation),{},{title:t})}}))}},{key:"onChangeSlug",value:function(e){var t=e.target.value;this.setState((function(e){return{currentLocation:Object(C.a)(Object(C.a)({},e.currentLocation),{},{slug:t})}}))}},{key:"onChangeDescription",value:function(e){var t=e.target.value;this.setState((function(e){return{currentLocation:Object(C.a)(Object(C.a)({},e.currentLocation),{},{description:t})}}))}},{key:"onChangeIntroduction",value:function(e){var t=e.target.value;this.setState((function(e){return{currentLocation:Object(C.a)(Object(C.a)({},e.currentLocation),{},{introduction:t})}}))}},{key:"onChangeYoutube",value:function(e){var t=e.target.value;this.setState((function(e){return{currentLocation:Object(C.a)(Object(C.a)({},e.currentLocation),{},{youtube_id:t})}}))}},{key:"onChangeCallToActionText",value:function(e){var t=e.target.value;this.setState((function(e){return{currentLocation:Object(C.a)(Object(C.a)({},e.currentLocation),{},{call_to_action_text:t})}}))}},{key:"onChangeCallToActionLink",value:function(e){var t=e.target.value;this.setState((function(e){return{currentLocation:Object(C.a)(Object(C.a)({},e.currentLocation),{},{call_to_action_link:t})}}))}},{key:"onChangeCallToActionButton",value:function(e){var t=e.target.value;this.setState((function(e){return{currentLocation:Object(C.a)(Object(C.a)({},e.currentLocation),{},{call_to_action_button:t})}}))}},{key:"onChangeHistory",value:function(e){this.setState((function(t){return{currentLocation:Object(C.a)(Object(C.a)({},t.currentLocation),{},{history:e})}}))}},{key:"onChangeAuthorId",value:function(e){var t=e.target.value;this.setState((function(e){return{currentLocation:Object(C.a)(Object(C.a)({},e.currentLocation),{},{authorId:t})}}))}},{key:"onChangeCategoryId",value:function(e){var t=e.target.value;this.setState((function(e){return{currentLocation:Object(C.a)(Object(C.a)({},e.currentLocation),{},{categoryId:t})}}))}},{key:"onChangeLatitude",value:function(e){var t=e.target.value;this.setState((function(e){return{currentLocation:Object(C.a)(Object(C.a)({},e.currentLocation),{},{latitude:t})}}))}},{key:"onChangeLongitude",value:function(e){var t=e.target.value;this.setState((function(e){return{currentLocation:Object(C.a)(Object(C.a)({},e.currentLocation),{},{longitude:t})}}))}},{key:"onSetLeadImage",value:function(e){console.log("lead iamge"),console.log(e);this.state;this.setState((function(t){return{currentLocation:Object(C.a)(Object(C.a)({},t.currentLocation),{},{lead_image:e})}}),this.updateLocation)}},{key:"getLocation",value:function(e){var t=this;O.get(e).then((function(e){t.setState({currentLocation:e.data}),t.state.isAdmin&&(t.getAuthor(e.data.authorId),t.getAllAuthors()),console.log(e.data)})).catch((function(e){console.log(e)}))}},{key:"getAuthor",value:function(e){var t=this;k.get(e).then((function(e){t.setState({}),console.log(e.data)})).catch((function(e){console.log(e)}))}},{key:"getAllAuthors",value:function(){var e=this;k.getAll().then((function(t){e.setState({allAuthors:t.data}),console.log(t.data)})).catch((function(e){console.log(e)}))}},{key:"getAllCategories",value:function(){var e=this;N.getAll().then((function(t){e.setState({allCategories:t.data}),console.log(t.data)})).catch((function(e){console.log(e)}))}},{key:"updatePublished",value:function(e){var t=this,n=this.prepareDataForUpdate(e);O.update(this.state.currentLocation.id,n).then((function(n){t.setState((function(t){return{currentLocation:Object(C.a)(Object(C.a)({},t.currentLocation),{},{published:e}),message:n.data.message,messageClass:"success"}})),t.getLocation(t.state.currentLocation.id)})).catch((function(e){console.log(e),t.setState({message:e,messageClass:"danger"}),t.getLocation(t.state.currentLocation.id)}))}},{key:"updateLocation",value:function(){var e=this,t=this.prepareDataForUpdate(this.state.currentLocation.published);O.update(this.state.currentLocation.id,t).then((function(t){e.setState({message:t.data.message,messageClass:"success"}),e.getLocation(e.state.currentLocation.id)})).catch((function(t){console.log(t),e.setState({message:t,messageClass:"danger"}),e.getLocation(e.state.currentLocation.id)}))}},{key:"prepareDataForUpdate",value:function(e){return this.setState({message:"",messageClass:"loading"}),{id:this.state.currentLocation.id,title:this.state.currentLocation.title,description:this.state.currentLocation.description,introduction:this.state.currentLocation.introduction,history:null==this.state.currentLocation.history?"":this.state.currentLocation.history,slug:this.state.currentLocation.slug,lead_image:this.state.currentLocation.lead_image,published:e,authorId:this.state.currentLocation.authorId,loggedInUser:this.state.loggedInUser,longitude:this.state.currentLocation.longitude,latitude:this.state.currentLocation.latitude,youtube_id:this.state.currentLocation.youtube_id,categoryId:this.state.currentLocation.categoryId,call_to_action_text:this.state.currentLocation.call_to_action_text,call_to_action_link:this.state.currentLocation.call_to_action_link,call_to_action_button:this.state.currentLocation.call_to_action_button}}},{key:"deleteLocation",value:function(){var e=this;window.confirm("Are you sure you want to delete this location?")&&O.delete(this.state.currentLocation.id).then((function(t){console.log(t.data),e.props.history.push("/locations")})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this,t=this.state.currentLocation;return Object(x.jsx)("div",{children:t?Object(x.jsx)("div",{className:"edit-form edit-location",children:Object(x.jsxs)("div",{className:"row",children:[Object(x.jsxs)("div",{className:"col-12",children:[Object(x.jsx)("h1",{children:"Edit Location"}),t.slug&&Object(x.jsxs)("p",{children:["View location: ",Object(x.jsx)("a",{target:"_blank",href:"https://map.savepublichousing.com/locations/"+t.slug,children:"https://map.savepublichousing.com/locations/"+t.slug})]})]}),Object(x.jsx)("div",{className:"col-sm-4 order-sm-2",children:Object(x.jsxs)("div",{className:"location-controls",children:[Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:Object(x.jsx)("strong",{children:"Status:"})}),t.published?"Published":"Pending"]}),(this.state.loggedInUser==t.authorId||this.state.isMod||this.state.isAdmin)&&Object(x.jsx)("button",{className:"btn btn-primary mr-2",onClick:function(){return e.updatePublished(!t.published)},children:t.published?"Set as draft":"Publish"}),(this.state.loggedInUser==t.authorId||this.state.isMod||this.state.isAdmin)&&Object(x.jsx)("button",{type:"submit",className:"btn btn-success mr-2",onClick:this.updateLocation,children:"Update"}),this.state.isAdmin&&Object(x.jsx)("button",{className:"btn btn-danger",onClick:this.deleteLocation,children:"Delete"}),Object(x.jsx)("p",{className:"alert alert-"+this.state.messageClass,children:this.state.message}),"loading"==this.state.messageClass&&Object(x.jsx)("div",{className:"spinner-border text-secondary",role:"status",children:Object(x.jsx)("span",{className:"sr-only",children:"Loading..."})})]})}),Object(x.jsx)("div",{className:"col-sm-8 order-sm-1",children:Object(x.jsxs)("form",{type:"",children:[Object(x.jsx)("div",{className:"card",children:Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"title",children:"Title"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"title",value:t.title,onChange:this.onChangeTitle})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"title",children:"URL"}),Object(x.jsx)("p",{className:"small",children:"https://map.savepublichousing.com/locations/"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"title",value:t.slug,onChange:this.onChangeSlug})]}),this.state.isAdmin&&t.authorId&&Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"authorId",children:"Author"}),Object(x.jsx)("select",{className:"form-control",id:"authorId",required:!0,value:t.authorId,onChange:this.onChangeAuthorId,name:"authorId",children:this.state.allAuthors&&0!=this.state.allAuthors.length&&this.state.allAuthors.map((function(e,t){return Object(x.jsxs)("option",{value:e.id,children:[e.username," (",e.email,")"]},e.id)}))})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"categoryId",children:"Category"}),Object(x.jsxs)("select",{className:"form-control",id:"categoryId",required:!0,value:t.categoryId||"0",onChange:this.onChangeCategoryId,name:"categoryId",children:[null===t.categoryId&&Object(x.jsx)("option",{value:"0"}),this.state.allCategories&&0!=this.state.allCategories.length&&this.state.allCategories.map((function(e,t){return Object(x.jsx)("option",{value:e.id,children:e.name},e.id)}))]})]}),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"latitude",children:"Latitude"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"latitude",value:t.latitude||"",onChange:this.onChangeLatitude})]})}),Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"longitude",children:"Longitude"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"longitude",value:t.longitude||"",onChange:this.onChangeLongitude})]})})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"description",children:"Description"}),Object(x.jsx)("p",{className:"small",children:"Describe the location in one sentence. This will be shown on the map pop ups."}),Object(x.jsx)("textarea",{type:"text",className:"form-control",id:"description",value:t.description,onChange:this.onChangeDescription})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"introduction",children:"Introduction"}),Object(x.jsx)("p",{className:"small",children:"One paragraph, emotive introduction to the location."}),Object(x.jsx)("textarea",{type:"text",className:"form-control paragraphs",id:"introduction",value:t.introduction||"",onChange:this.onChangeIntroduction})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"youtube_id",children:"YouTube ID"}),Object(x.jsx)("p",{className:"small",children:"Enter the ID of the YouTube video. You can find the ID in the url. For example, for https://www.youtube.com/watch?v=Jn09UdSb3aA the ID is Jn09UdSb3aA"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"youtube_id",value:t.youtube_id||"",onChange:this.onChangeYoutube})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"history",children:"History"}),Object(x.jsx)("p",{className:"small",children:"A detailed history of the location, and any other relevant information."}),Object(x.jsx)(U,{"data-lpignore":"true",id:"history",content:t.history||"",onChange:this.onChangeHistory})]})]})}),Object(x.jsx)("div",{className:"form-group",children:Object(x.jsxs)("div",{className:"location-library",children:[Object(x.jsx)("h2",{children:"Call to action"}),Object(x.jsx)("div",{className:"card",children:Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("label",{htmlFor:"call_to_action_text",children:"Text"}),Object(x.jsx)("p",{className:"small",children:'A short paragraph explaining the action, e.g. "Take five minutes to sign our petition." or "Write to the Minister for Housing at email@address.com."'}),Object(x.jsx)("textarea",{className:"form-control",id:"call_to_action_text",value:t.call_to_action_text||"",onChange:this.onChangeCallToActionText}),Object(x.jsx)("label",{htmlFor:"call_to_action_link",children:"Link"}),Object(x.jsx)("p",{className:"small",children:"An optional link to another website, e.g. change.org."}),Object(x.jsx)("input",{type:"url",className:"form-control",id:"call_to_action_link",value:t.call_to_action_link||"",onChange:this.onChangeCallToActionLink}),Object(x.jsx)("label",{htmlFor:"call_to_action_button",children:"Button text"}),Object(x.jsx)("p",{className:"small",children:'Optional. Defaults to "Take action now".'}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"call_to_action_button",value:t.call_to_action_button||"",onChange:this.onChangeCallToActionButton})]})})]})}),Object(x.jsx)("div",{className:"form-group",children:Object(x.jsx)(R,{id:"images",location:t.id||"",lead_image:t.lead_image,onSetLeadImage:this.onSetLeadImage})}),Object(x.jsx)("div",{className:"form-group",children:Object(x.jsx)(F,{id:"residents",location:t.id||""})}),Object(x.jsx)("div",{className:"form-group",children:Object(x.jsx)(E,{id:"resources",location:t.id||""})})]})})]})}):Object(x.jsxs)("div",{children:[Object(x.jsx)("br",{}),Object(x.jsx)("p",{children:"No location found with this id"})]})})}}]),n}(a.Component),H=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).onChangeSearchTitle=a.onChangeSearchTitle.bind(Object(d.a)(a)),a.onToggleOwnFilter=a.onToggleOwnFilter.bind(Object(d.a)(a)),a.retrieveLocations=a.retrieveLocations.bind(Object(d.a)(a)),a.refreshList=a.refreshList.bind(Object(d.a)(a)),a.setActiveLocation=a.setActiveLocation.bind(Object(d.a)(a)),a.removeAllLocations=a.removeAllLocations.bind(Object(d.a)(a)),a.searchTitle=a.searchTitle.bind(Object(d.a)(a)),a.state={locations:[],currentLocation:null,currentIndex:-1,searchTitle:"",loggedInUser:null,isLoggedIn:!1,isMod:!1,isAdmin:!1,hideOtherAuthors:!1},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=f.getCurrentUser();e&&(this.setState({loggedInUser:e.id,isLoggedIn:!0,isMod:e.roles.includes("ROLE_MODERATOR"),isAdmin:e.roles.includes("ROLE_ADMIN")}),console.log(e)),this.retrieveLocations()}},{key:"onChangeSearchTitle",value:function(e){var t=e.target.value;this.setState({searchTitle:t})}},{key:"onToggleOwnFilter",value:function(e){var t=this;e.target.value;this.setState({hideOtherAuthors:!this.state.hideOtherAuthors}),this.setState({currentLocation:null,currentIndex:-1}),this.state.hideOtherAuthors?this.retrieveLocations():O.findByAuthor(this.state.loggedInUser).then((function(e){t.setState({locations:e.data}),console.log(e.data)})).catch((function(e){console.log(e)}))}},{key:"retrieveLocations",value:function(){var e=this;O.getAll().then((function(t){e.setState({locations:t.data}),console.log(t.data)})).catch((function(e){console.log(e)}))}},{key:"refreshList",value:function(){this.retrieveLocations(),this.setState({currentLocation:null,currentIndex:-1})}},{key:"setActiveLocation",value:function(e,t){this.setState({currentLocation:e,currentIndex:t})}},{key:"removeAllLocations",value:function(){var e=this;O.deleteAll().then((function(t){console.log(t.data),e.refreshList()})).catch((function(e){console.log(e)}))}},{key:"searchTitle",value:function(){var e=this;this.setState({currentLocation:null,currentIndex:-1}),O.findByTitle(this.state.searchTitle).then((function(t){e.setState({locations:t.data}),console.log(t.data)})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.searchTitle,a=t.locations,s=t.currentLocation,o=t.currentIndex;return Object(x.jsxs)("div",{className:"list row",children:[Object(x.jsx)("div",{className:"col-md-8",children:Object(x.jsxs)("div",{className:"input-group mb-3",children:[Object(x.jsx)("input",{type:"text",className:"form-control",placeholder:"Search by title",value:n,onChange:this.onChangeSearchTitle}),Object(x.jsx)("div",{className:"input-group-append",children:Object(x.jsx)("button",{className:"btn btn-outline-secondary",type:"button",onClick:this.searchTitle,children:"Search"})})]})}),Object(x.jsx)("div",{className:"col-md-8",children:Object(x.jsxs)("label",{children:[Object(x.jsx)(M.a,{defaultChecked:this.state.hideOtherAuthors,onChange:this.onToggleOwnFilter}),Object(x.jsx)("br",{}),Object(x.jsx)("span",{children:"Show only my locations"})]})}),Object(x.jsxs)("div",{className:"col-md-6",children:[Object(x.jsx)("h4",{children:"Locations List"}),Object(x.jsx)("ul",{className:"list-group",children:a&&a.map((function(t,n){return Object(x.jsx)("li",{className:"list-group-item "+(n===o?"active":""),onClick:function(){return e.setActiveLocation(t,n)},children:t.title},n)}))})]}),Object(x.jsx)("div",{className:"col-md-6",children:s?Object(x.jsxs)("div",{children:[Object(x.jsx)("h4",{children:"Location"}),Object(x.jsxs)("div",{children:[Object(x.jsx)("label",{children:Object(x.jsx)("strong",{children:"Title:"})})," ",s.title]}),Object(x.jsxs)("div",{children:[Object(x.jsx)("label",{children:Object(x.jsx)("strong",{children:"Description:"})})," ",s.description]}),Object(x.jsxs)("div",{children:[Object(x.jsx)("label",{children:Object(x.jsx)("strong",{children:"Status:"})})," ",s.published?"Published":"Pending"]}),(this.state.loggedInUser==s.authorId||this.state.isMod||this.state.isAdmin)&&Object(x.jsx)(c.b,{to:"/admin/locations/"+s.id,className:"badge badge-warning",children:"Edit"})]}):Object(x.jsxs)("div",{children:[Object(x.jsx)("br",{}),Object(x.jsx)("p",{children:"Please click on a Location..."})]})})]})}}]),n}(a.Component),q=new(function(){function e(){Object(r.a)(this,e)}return Object(l.a)(e,[{key:"getAll",value:function(){return m.get("/options",{headers:p()})}},{key:"get",value:function(e){return m.get("/options/".concat(e),{headers:p()})}},{key:"create",value:function(e){return m.post("/options",e,{headers:p()})}},{key:"update",value:function(e,t){return m.put("/options/".concat(e),t,{headers:p()})}},{key:"delete",value:function(e){return m.delete("/options/".concat(e),{headers:p()})}}]),e}()),J=n(54),z=n.n(J),W=n(94);z.a.workerClass=W.a,z.a.accessToken="pk.eyJ1IjoibWVsbW8iLCJhIjoiY2treXFvMDV1MDJmcTJvcG50dGMzY2QxdiJ9.puFYcwcSHldVsybUrC8HlA";var Y={position:"absolute",zIndex:10,display:"flex",flexDirection:"column",boxShadow:"0px 1px 4px rgba(0, 0, 0, .3)",border:"1px solid rgba(0, 0, 0, 0.1)",bottom:40,right:10,top:"auto",left:"auto"},G={"top-right":{top:10,right:10,bottom:"auto",left:"auto"},"top-left":{top:10,left:10,bottom:"auto",right:"auto"},"bottom-right":{bottom:10,right:10,top:"auto",left:"auto"},"bottom-left":{bottom:10,left:10,top:"auto",right:"auto"}},V={backgroundColor:"#f9f9f9",opacity:.95,transition:"background-color 0.16s ease-out",cursor:"pointer",border:0,height:26,width:26,backgroundImage:"url('https://api.mapbox.com/mapbox.js/v2.4.0/images/icons-000000@2x.png')",backgroundPosition:"0px 0px",backgroundSize:"26px 260px",outline:0},Z={backgroundColor:"#fff",opacity:1},Q={borderBottom:"1px solid rgba(0, 0, 0, 0.1)",borderTopLeftRadius:2,borderTopRightRadius:2},X={backgroundPosition:"0px -26px",borderBottomLeftRadius:2,borderBottomRightRadius:2},$=(Object.keys(G),function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).onMouseOut=a.onMouseOut.bind(Object(d.a)(a)),a.plusOver=a.plusOver.bind(Object(d.a)(a)),a.minusOver=a.minusOver.bind(Object(d.a)(a)),a.onClickPlus=a.onClickPlus.bind(Object(d.a)(a)),a.onClickMinus=a.onClickMinus.bind(Object(d.a)(a)),a.state={hover:void 0},a}return Object(l.a)(n,[{key:"onMouseOut",value:function(){this.setState({hover:void 0})}},{key:"plusOver",value:function(){0!==this.state.hover&&this.setState({hover:0})}},{key:"minusOver",value:function(){1!==this.state.hover&&this.setState({hover:1})}},{key:"onClickPlus",value:function(){this.props.map.zoomTo(this.props.map.getZoom()+.5)}},{key:"onClickMinus",value:function(){this.props.map.zoomTo(this.props.map.getZoom()-.5)}},{key:"render",value:function(){var e=this.props,t=(e.position,e.style),n=e.className,a=e.tabIndex,s=this.state.hover,o=Object(C.a)(Object(C.a)(Object(C.a)({},V),Q),0===s?Z:{}),i=Object(C.a)(Object(C.a)(Object(C.a)({},V),X),1===s?Z:{});return Object(x.jsxs)("div",{className:n,tabIndex:a,style:Object(C.a)(Object(C.a)(Object(C.a)({},Y),G[1]),t),children:[Object(x.jsx)("button",{id:"zoomIn",type:"button",style:o,"aria-label":"Zoom in",onMouseOver:this.plusOver,onMouseOut:this.onMouseOut,onClick:this.onClickPlus}),Object(x.jsx)("button",{id:"zoomOut",type:"button",style:i,"aria-label":"Zoom out",onMouseOver:this.minusOver,onMouseOut:this.onMouseOut,onClick:this.onClickMinus})]})}}]),n}(s.a.Component));z.a.workerClass=W.a,z.a.accessToken="pk.eyJ1IjoibWVsbW8iLCJhIjoiY2treXFvMDV1MDJmcTJvcG50dGMzY2QxdiJ9.puFYcwcSHldVsybUrC8HlA";var K=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).getLocationData=a.getLocationData.bind(Object(d.a)(a)),a.getPublishedLocations=a.getPublishedLocations.bind(Object(d.a)(a)),a.getCategories=a.getCategories.bind(Object(d.a)(a)),a.getLocation=a.getLocation.bind(Object(d.a)(a)),a.formatGeoJSON=a.formatGeoJSON.bind(Object(d.a)(a)),a.initMap=a.initMap.bind(Object(d.a)(a)),a.state={locations:[],currentLocation:null,lat:a.props.lat||-37.81333017785542,lng:a.props.lng||144.9614772172758,zoom:a.props.zoom||9,map:null,categories:[],catColors:{}},a.mapContainer=s.a.createRef(),a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.getCategories(),this.getLocationData()}},{key:"componentDidUpdate",value:function(e,t,n){this.props.latitude===e.latitude&&this.props.longitude===e.longitude&&this.props.id===e.id||(this.setState({lat:this.props.lat||-37.81333017785542,lng:this.props.lng||144.9614772172758,zoom:this.props.zoom||9}),this.getLocationData())}},{key:"componentWillUnmount",value:function(){null!==this.state.map&&this.state.map.remove()}},{key:"getLocationData",value:function(){this.props.id?this.getLocation(this.props.id):this.getPublishedLocations()}},{key:"getPublishedLocations",value:function(){var e=this;O.getPublished().then((function(t){console.log(t.data),e.setState({locations:e.formatGeoJSON(t.data)}),e.initMap(),console.log(e.state.locations)})).catch((function(e){console.log(e)}))}},{key:"getLocation",value:function(e){var t=this;O.get(e).then((function(e){console.log("response.data"),console.log(e.data),t.setState({locations:t.formatGeoJSON([e.data])}),t.initMap()})).catch((function(e){console.log(e)}))}},{key:"getCategories",value:function(e){var t=this;N.getAll().then((function(n){console.log(n.data);var a={};n.data.forEach((function(e){a[e.id.toString()]=e.color})),t.setState({categories:n.data,catColors:a}),console.log("state"),console.log(t.state),"function"===typeof e&&e()})).catch((function(e){console.log(e)}))}},{key:"initMap",value:function(){var e=this;null!==this.state.map&&this.state.map.remove();var t=this.state,n=t.lng,a=t.lat,s=t.zoom,o=new z.a.Map({container:this.mapContainer.current,style:"mapbox://styles/melmo/ckotwhxhj670j17p61zhj5x3p",center:[n,a],zoom:s});this.setState({map:o}),o.on("move",(function(){e.setState({lng:o.getCenter().lng.toFixed(4),lat:o.getCenter().lat.toFixed(4),zoom:o.getZoom().toFixed(2)})})),console.log(),o.on("load",(function(){o.addSource("locations",{type:"geojson",data:e.state.locations}),o.addLayer({id:"locations",type:"symbol",source:"locations",layout:{"text-line-height":1,"text-padding":0,"text-anchor":"center","text-offset":[0,-.3],"text-allow-overlap":!0,"text-ignore-placement":!0,"text-field":String.fromCharCode(61505),"text-font":["Font Awesome 5 Free Solid"],"text-size":15,"icon-optional":!0,"icon-allow-overlap":!0,"icon-size":1},paint:{"text-color":["get",["get","category"],["literal",e.state.catColors]]}})})),this.props.id||(o.on("click","locations",(function(e){for(var t=e.features[0].geometry.coordinates.slice(),n=e.features[0].properties.description;Math.abs(e.lngLat.lng-t[0])>180;)t[0]+=e.lngLat.lng>t[0]?360:-360;(new z.a.Popup).setLngLat(t).setHTML(n).addTo(o)})),o.on("mouseenter","locations",(function(){o.getCanvas().style.cursor="pointer"})),o.on("mouseleave","locations",(function(){o.getCanvas().style.cursor=""})))}},{key:"formatGeoJSON",value:function(e){var t=e.map((function(e,t){if(e.images&&e.lead_image)var n=e.images.find((function(t){return t.id==e.lead_image}));var a='<a class="popup" target="_blank" href="https://map.savepublichousing.com/locations/'+e.slug+'"><h4>'+e.title+"</h4>";return n&&(a+='<img src="'+n.url+'"/>'),{type:"Feature",properties:{description:a+="<div>"+e.description+"</div></a>",category:e.categoryId?e.categoryId.toString():"0",color:""},geometry:{type:"Point",coordinates:[e.longitude,e.latitude]}}})),n={type:"FeatureCollection",features:t};return console.log(t),n}},{key:"render",value:function(){return Object(x.jsxs)("div",{className:"",children:[Object(x.jsx)("div",{id:"map",ref:this.mapContainer,className:"map-container"}),Object(x.jsx)($,{map:this.state.map}),!this.props.id&&this.state.categories&&Object(x.jsxs)("div",{id:"legend",children:[Object(x.jsx)("h5",{children:"Categories"}),this.state.categories.map((function(e){return Object(x.jsxs)("p",{children:[Object(x.jsx)("span",{className:"color-block",style:{backgroundColor:e.color}}),e.name]},e.id)}))]})]})}}]),n}(a.Component),ee=function(e){var t=e.embedId;return Object(x.jsx)("div",{className:"video-responsive",children:Object(x.jsx)("iframe",{width:"853",height:"480",src:"https://www.youtube.com/embed/".concat(t),frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})},te=n(120),ne=n.n(te),ae=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).getLocation=a.getLocation.bind(Object(d.a)(a)),a.getImages=a.getImages.bind(Object(d.a)(a)),a.getResidents=a.getResidents.bind(Object(d.a)(a)),a.getResources=a.getResources.bind(Object(d.a)(a)),a.getOptions=a.getOptions.bind(Object(d.a)(a)),a.state={currentLocation:{id:null,title:"",description:"",published:!1,authorId:null,latitude:null,longitude:null,history:"",introduction:"",youtube_id:"",call_to_action_text:"",call_to_action_link:"",call_to_action_button:""},images:[],residents:[],resources:[],options:{}},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.getLocation(this.props.match.params.slug),this.getOptions()}},{key:"getLocation",value:function(e){var t=this;console.log(e),O.findBySlug(e).then((function(e){console.log("response.data"),console.log(e.data),t.setState({currentLocation:e.data}),null!==t.state.currentLocation&&(t.getImages(t.state.currentLocation.id),t.getResidents(t.state.currentLocation.id),t.getResources(t.state.currentLocation.id))})).catch((function(e){console.log("e.data"),console.log(e)}))}},{key:"getImages",value:function(e){var t=this;A.findByLocation(e).then((function(e){t.setState({images:e.data}),console.log(e.data)})).catch((function(e){console.log(e)}))}},{key:"getResidents",value:function(e){var t=this;T.findByLocation(e).then((function(e){t.setState({residents:e.data})})).catch((function(e){console.log(e)}))}},{key:"getResources",value:function(e){var t=this;P.findByLocation(e).then((function(e){t.setState({resources:e.data}),console.log(e.data)})).catch((function(e){console.log(e)}))}},{key:"getOptions",value:function(){var e=this;q.get(1).then((function(t){console.log("options"),console.log(t.data),e.setState({options:t.data})})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this.state,t=e.currentLocation,n=e.images,a=e.residents,s=e.resources;return Object(x.jsx)("div",{className:"location-view",children:t?Object(x.jsxs)("div",{className:"",children:[Object(x.jsx)("h1",{children:t.title}),Object(x.jsx)("div",{className:"introduction",children:t.introduction}),Object(x.jsx)("div",{id:"images",children:Object(x.jsx)(ne.a,{dots:!0,infinite:!0,speed:500,slidesToShow:1,slidesToScroll:1,autoplay:!0,arrows:!1,children:n.map((function(e){return Object(x.jsx)("div",{children:Object(x.jsx)("img",{src:e.url})},e.id)}))})}),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsx)("div",{className:"col-12"}),Object(x.jsxs)("div",{className:"col-md-8",children:[t.history&&""!==t.history&&Object(x.jsx)("div",{dangerouslySetInnerHTML:{__html:t.history}}),t.youtube_id&&""!==t.youtube_id&&Object(x.jsx)("div",{id:"youtube",children:Object(x.jsx)(ee,{embedId:t.youtube_id})})]}),Object(x.jsx)("div",{className:"col-md-4",children:Object(x.jsx)("div",{className:"map-wrap-small",children:Object(x.jsx)(K,{zoom:"13",lat:t.latitude,lng:t.longitude,id:t.id})})})]}),Object(x.jsx)("div",{className:"row",children:Object(x.jsxs)("div",{className:"col-sm-8 offset-sm-2",children:[t.call_to_action_link&&Object(x.jsxs)("div",{className:"call-to-action",children:[t.call_to_action_text&&Object(x.jsx)("p",{children:t.call_to_action_text}),Object(x.jsx)("a",{target:"_blank",className:"btn btn-lg btn-action",href:t.call_to_action_link,children:t.call_to_action_button||"Take action now"})]}),!t.call_to_action_link&&this.state.options.call_to_action_link&&Object(x.jsxs)("div",{className:"call-to-action",children:[this.state.options.call_to_action_text&&Object(x.jsx)("p",{children:this.state.options.call_to_action_text}),Object(x.jsx)("a",{target:"_blank",className:"btn btn-lg btn-action",href:this.state.options.call_to_action_link,children:this.state.options.call_to_action_button||"Take action now"})]})]})}),Object(x.jsxs)("div",{className:"row",children:[a.length>0&&Object(x.jsxs)("div",{id:"residents",className:"col-12",children:[Object(x.jsx)("h2",{children:"Resident Stories"}),Object(x.jsx)("div",{children:Object(x.jsx)("div",{className:"col-sm-8 offset-sm-2",children:Object(x.jsx)(ne.a,{settings:{dots:!0,infinite:!0,speed:500,slidesToShow:1,slidesToScroll:1},children:a.map((function(e){return Object(x.jsx)("div",{className:"card",children:Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("h5",{className:"card-title",children:e.name}),Object(x.jsx)("div",{children:e.story})]})},e.id)}))})})})]}),s.length>0&&Object(x.jsxs)("div",{className:"col-12",children:[Object(x.jsx)("h2",{children:"Further resources"}),Object(x.jsx)("ul",{id:"resources",children:s.map((function(e){return Object(x.jsxs)("li",{children:[Object(x.jsx)("a",{target:"_blank",href:e.url,children:e.name}),Object(x.jsx)("br",{}),Object(x.jsx)("p",{children:e.description})]},e.id)}))})]})]})]}):Object(x.jsxs)("div",{children:[Object(x.jsx)("br",{}),Object(x.jsx)("p",{children:"No location found"})]})})}}]),n}(a.Component),se=n(44),oe=n.n(se),ie=n(31),ce=n.n(ie),re=n(45),le=n.n(re),de=n(48),ue=function(e){if(!e)return Object(x.jsx)("div",{className:"alert alert-danger",role:"alert",children:"This field is required!"})},he=function(e){if(!Object(de.isEmail)(e))return Object(x.jsx)("div",{className:"alert alert-danger",role:"alert",children:"This is not a valid email."})},be=function(e){if(e.length<3||e.length>20)return Object(x.jsx)("div",{className:"alert alert-danger",role:"alert",children:"The username must be between 3 and 20 characters."})},je=function(e){if(e.length<6||e.length>40)return Object(x.jsx)("div",{className:"alert alert-danger",role:"alert",children:"The password must be between 6 and 40 characters."})},ge=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).onChangeUsername=a.onChangeUsername.bind(Object(d.a)(a)),a.onChangePassword=a.onChangePassword.bind(Object(d.a)(a)),a.onChangeRole=a.onChangeRole.bind(Object(d.a)(a)),a.onChangeEmail=a.onChangeEmail.bind(Object(d.a)(a)),a.saveUser=a.saveUser.bind(Object(d.a)(a)),a.newUser=a.newUser.bind(Object(d.a)(a)),a.state={id:null,username:"",email:"",role:1,password:"",success:!1,message:""},a}return Object(l.a)(n,[{key:"onChangeUsername",value:function(e){this.setState({username:e.target.value})}},{key:"onChangeEmail",value:function(e){this.setState({email:e.target.value})}},{key:"onChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"onChangeRole",value:function(e){this.setState({role:e.target.value})}},{key:"saveUser",value:function(e){var t=this;if(e.preventDefault(),this.form.validateAll(),0===this.checkBtn.context._errors.length){var n={user:{username:this.state.username,email:this.state.email,password:this.state.password,role:this.state.role}};k.create(n).then((function(e){console.log(e),e.data.success?t.setState({id:e.data.user.id,username:e.data.user.username,email:e.data.user.email,role:e.data.user.role,success:e.data.success,message:e.data.message}):t.setState({success:e.data.success,message:e.data.message}),console.log(e.data)})).catch((function(e){console.log(e)}))}}},{key:"newUser",value:function(){this.setState({id:null,email:"",username:"",password:"",role:1,message:"",success:!1})}},{key:"render",value:function(){var e=this;return Object(x.jsx)("div",{className:"submit-form",children:this.state.success?Object(x.jsxs)("div",{children:[Object(x.jsx)("h4",{children:this.state.message}),Object(x.jsx)("a",{className:"btn",href:"/admin/users/"+this.state.id,children:"View user"}),Object(x.jsx)("button",{className:"btn",onClick:this.newUser,children:"Add another user"})]}):Object(x.jsxs)("div",{children:[Object(x.jsx)("h4",{children:"Add new user"}),Object(x.jsxs)(oe.a,{onSubmit:this.saveUser,ref:function(t){e.form=t},children:[Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"username",children:"Username"}),Object(x.jsx)(ce.a,{type:"text",className:"form-control",id:"username",validations:[ue,be],value:this.state.username,onChange:this.onChangeUsername,name:"username"})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"email",children:"Email"}),Object(x.jsx)(ce.a,{type:"email",className:"form-control",id:"email",validations:[ue,he],value:this.state.email,onChange:this.onChangeEmail,name:"email"})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"password",children:"Password"}),Object(x.jsx)(ce.a,{type:"password",className:"form-control",id:"password",validations:[ue,je],value:this.state.password,onChange:this.onChangePassword,name:"password"})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"role",children:"Role"}),Object(x.jsxs)("select",{className:"form-control",id:"role",required:!0,value:this.state.role,onChange:this.onChangeRole,name:"role",children:[Object(x.jsx)("option",{value:"1",children:"User"}),Object(x.jsx)("option",{value:"2",children:"Moderator"}),Object(x.jsx)("option",{value:"3",children:"Admin"})]})]}),Object(x.jsx)("button",{className:"btn btn-success",children:"Submit"}),Object(x.jsx)("p",{children:this.state.message}),Object(x.jsx)(le.a,{style:{display:"none"},ref:function(t){e.checkBtn=t}})]})]})})}}]),n}(a.Component),me=function(e){if(!e)return Object(x.jsx)("div",{className:"alert alert-danger",role:"alert",children:"This field is required!"})},pe=function(e){if(!Object(de.isEmail)(e))return Object(x.jsx)("div",{className:"alert alert-danger",role:"alert",children:"This is not a valid email."})},Oe=function(e){if(e.length<3||e.length>20)return Object(x.jsx)("div",{className:"alert alert-danger",role:"alert",children:"The username must be between 3 and 20 characters."})},ve=function(e){if(e.length<6||e.length>40)return Object(x.jsx)("div",{className:"alert alert-danger",role:"alert",children:"The password must be between 6 and 40 characters."})},fe=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).onChangeUsername=a.onChangeUsername.bind(Object(d.a)(a)),a.onChangeEmail=a.onChangeEmail.bind(Object(d.a)(a)),a.onChangePassword=a.onChangePassword.bind(Object(d.a)(a)),a.onChangeDoUpdatePassword=a.onChangeDoUpdatePassword.bind(Object(d.a)(a)),a.onChangeRoleId=a.onChangeRoleId.bind(Object(d.a)(a)),a.getUser=a.getUser.bind(Object(d.a)(a)),a.updateUser=a.updateUser.bind(Object(d.a)(a)),a.deleteUser=a.deleteUser.bind(Object(d.a)(a)),a.state={currentUser:{id:null,username:"",email:"",roleId:0,password:""},message:"",isLoggedIn:!1,isAdmin:!1,isMod:!1,loggedInUser:0,newPassword:"",doUpdatePassword:!1},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=f.getCurrentUser();e&&this.setState({loggedInUser:e.id,isLoggedIn:!0,isMod:e.roles.includes("ROLE_MODERATOR"),isAdmin:e.roles.includes("ROLE_ADMIN")}),void 0!==this.props.match?this.getUser(this.props.match.params.id):this.getUser(this.props.id),console.log(this.state.currentUser)}},{key:"onChangeDoUpdatePassword",value:function(e){this.setState({doUpdatePassword:!this.state.doUpdatePassword})}},{key:"onChangePassword",value:function(e){var t=e.target.value;this.setState((function(e){return{currentUser:Object(C.a)(Object(C.a)({},e.currentUser),{},{password:t}),newPassword:t}}))}},{key:"onChangeUsername",value:function(e){var t=e.target.value;this.setState((function(e){return{currentUser:Object(C.a)(Object(C.a)({},e.currentUser),{},{username:t})}}))}},{key:"onChangeEmail",value:function(e){var t=e.target.value;this.setState((function(e){return{currentUser:Object(C.a)(Object(C.a)({},e.currentUser),{},{email:t})}}))}},{key:"onChangeRoleId",value:function(e){var t=e.target.value;this.setState((function(e){return{currentUser:Object(C.a)(Object(C.a)({},e.currentUser),{},{roleId:t})}}))}},{key:"getUser",value:function(e){var t=this;k.get(e).then((function(e){t.setState({currentUser:e.data}),console.log(e.data)})).catch((function(e){console.log(e)}))}},{key:"updateUser",value:function(e){var t=this;e.preventDefault(),this.form.validateAll(),0===this.checkBtn.context._errors.length&&k.update(this.state.currentUser.id,{user:this.state.currentUser,updatePassword:!!this.state.newPassword}).then((function(e){console.log("updated"),console.log(e.data),t.getUser(t.state.currentUser.id),t.setState((function(t){return{message:e.data.message,newPassword:"",doUpdatePassword:!1}}))})).catch((function(e){console.log(e)}))}},{key:"deleteUser",value:function(){var e=this;k.delete(this.state.currentUser.id).then((function(t){console.log(t.data),e.props.history.push("/admin/users")})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.currentUser,a=t.isAdmin,s=t.loggedInUser,o=t.newPassword,i=t.doUpdatePassword;return Object(x.jsx)("div",{children:n?Object(x.jsxs)("div",{className:"edit-form",children:[Object(x.jsx)("h4",{children:n.username}),Object(x.jsxs)(oe.a,{onSubmit:this.saveUser,ref:function(t){e.form=t},children:[Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"username",children:"Username"}),Object(x.jsx)(ce.a,{type:"text",className:"form-control",id:"username",validations:[me,Oe],value:n.username,onChange:this.onChangeUsername})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"email",children:"Email"}),Object(x.jsx)(ce.a,{type:"email",className:"form-control",id:"email",validations:[me,pe],value:n.email,onChange:this.onChangeEmail})]}),a&&s!==n.id?Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"roleId",children:"Role"}),Object(x.jsxs)("select",{className:"form-control",id:"roleId",required:!0,value:n.roleId,onChange:this.onChangeRoleId,name:"roleId",children:[Object(x.jsx)("option",{value:"1",children:"User"}),Object(x.jsx)("option",{value:"2",children:"Moderator"}),Object(x.jsx)("option",{value:"3",children:"Admin"})]})]}):Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"roleDisplay",children:"Role"}),Object(x.jsx)(ce.a,{disabled:!0,className:"form-control",id:"roleDisplay",name:"roleDisplay",value:{0:"",1:"User",2:"Moderator",3:"Admin"}[n.roleId]})]}),(a||s===n.id)&&!i&&Object(x.jsx)("div",{className:"form-group",children:Object(x.jsx)("button",{className:"badge",onClick:this.onChangeDoUpdatePassword,children:"Change password"})}),(a||s===n.id)&&i&&Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"password",children:"Password"}),Object(x.jsx)(ce.a,{type:"password",className:"form-control",id:"password",validations:[ve],value:o,onChange:this.onChangePassword,name:"password"})]}),a&&s!==n.id&&Object(x.jsx)("button",{className:"badge badge-danger mr-2",onClick:this.deleteUser,children:"Delete"}),Object(x.jsx)("button",{type:"submit",className:"badge badge-success",onClick:this.updateUser,children:"Update"}),Object(x.jsx)(le.a,{style:{display:"none"},ref:function(t){e.checkBtn=t}})]}),Object(x.jsx)("p",{children:this.state.message})]}):Object(x.jsxs)("div",{children:[Object(x.jsx)("br",{}),Object(x.jsx)("p",{children:"Please click on a User..."})]})})}}]),n}(a.Component),xe=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).onChangeSearchUsername=a.onChangeSearchUsername.bind(Object(d.a)(a)),a.retrieveUsers=a.retrieveUsers.bind(Object(d.a)(a)),a.refreshList=a.refreshList.bind(Object(d.a)(a)),a.setActiveUser=a.setActiveUser.bind(Object(d.a)(a)),a.removeAllUsers=a.removeAllUsers.bind(Object(d.a)(a)),a.searchUsername=a.searchUsername.bind(Object(d.a)(a)),a.state={users:[],currentUser:null,currentIndex:-1,searchUsername:""},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.retrieveUsers()}},{key:"onChangeSearchUsername",value:function(e){var t=e.target.value;this.setState({searchUsername:t})}},{key:"retrieveUsers",value:function(){var e=this;k.getAll().then((function(t){e.setState({users:t.data}),console.log(t.data)})).catch((function(e){console.log(e)}))}},{key:"refreshList",value:function(){this.retrieveUsers(),this.setState({currentUser:null,currentIndex:-1})}},{key:"setActiveUser",value:function(e,t){this.setState({currentUser:e,currentIndex:t})}},{key:"removeAllUsers",value:function(){var e=this;k.deleteAll().then((function(t){console.log(t.data),e.refreshList()})).catch((function(e){console.log(e)}))}},{key:"searchUsername",value:function(){var e=this;this.setState({currentUsername:null,currentIndex:-1}),k.findByUsername(this.state.searchUsername).then((function(t){e.setState({users:t.data}),console.log(t.data)})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.searchUsername,a=t.users,s=t.currentUser,o=t.currentIndex;return Object(x.jsxs)("div",{className:"list row",children:[Object(x.jsx)("div",{className:"col-md-8",children:Object(x.jsxs)("div",{className:"input-group mb-3",children:[Object(x.jsx)("input",{type:"text",className:"form-control",placeholder:"Search by username",value:n,onChange:this.onChangeSearchUsername}),Object(x.jsx)("div",{className:"input-group-append",children:Object(x.jsx)("button",{className:"btn btn-outline-secondary",type:"button",onClick:this.searchUsername,children:"Search"})})]})}),Object(x.jsxs)("div",{className:"col-md-6",children:[Object(x.jsx)("h4",{children:"Users List"}),Object(x.jsx)("ul",{className:"list-group",children:a&&a.map((function(t,n){return Object(x.jsx)("li",{className:"list-group-item "+(n===o?"active":""),onClick:function(){return e.setActiveUser(t,n)},children:t.username},n)}))})]}),Object(x.jsx)("div",{className:"col-md-6",children:s?Object(x.jsxs)("div",{children:[Object(x.jsx)("h4",{children:"User"}),Object(x.jsxs)("div",{children:[Object(x.jsx)("label",{children:Object(x.jsx)("strong",{children:"Username:"})})," ",s.username]}),Object(x.jsxs)("div",{children:[Object(x.jsx)("label",{children:Object(x.jsx)("strong",{children:"Email:"})})," ",s.email]}),Object(x.jsxs)("div",{children:[Object(x.jsx)("label",{children:Object(x.jsx)("strong",{children:"Role:"})})," ",{1:"User",2:"Moderator",3:"Admin"}[s.roleId]]}),Object(x.jsx)(c.b,{to:"/admin/users/"+s.id,className:"badge badge-warning",children:"Edit"})]}):Object(x.jsxs)("div",{children:[Object(x.jsx)("br",{}),Object(x.jsx)("p",{children:"Please click on a user"})]})})]})}}]),n}(a.Component),ye=n(99);function Ce(e){var t=e.component,n=e.auth,a=e.authCheckComplete,s=Object(ye.a)(e,["component","auth","authCheckComplete"]);return console.log("auth: "+n),Object(x.jsx)(b.b,Object(C.a)(Object(C.a)({},s),{},{render:function(e){return!1===a?Object(x.jsx)("div",{}):!0===n?Object(x.jsx)(t,Object(C.a)({},e)):Object(x.jsx)(b.a,{to:{pathname:"/login",state:{from:e.location}}})}}))}var ke=function(e){if(!e)return Object(x.jsx)("div",{className:"alert alert-danger",role:"alert",children:"This field is required!"})},Ne=function(e){if(!Object(de.isEmail)(e))return Object(x.jsx)("div",{className:"alert alert-danger",role:"alert",children:"This is not a valid email."})},we=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).handleLogin=a.handleLogin.bind(Object(d.a)(a)),a.onChangeEmail=a.onChangeEmail.bind(Object(d.a)(a)),a.onChangePassword=a.onChangePassword.bind(Object(d.a)(a)),a.state={email:"",password:"",loading:!1,message:""},a}return Object(l.a)(n,[{key:"onChangeEmail",value:function(e){this.setState({email:e.target.value})}},{key:"onChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"handleLogin",value:function(e){var t=this;e.preventDefault(),this.setState({message:"",loading:!0}),this.form.validateAll(),0===this.checkBtn.context._errors.length?f.login(this.state.email,this.state.password).then((function(){console.log(t.props),window.location.pathname="/admin/locations"}),(function(e){var n=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();t.setState({loading:!1,message:n})})):this.setState({loading:!1})}},{key:"render",value:function(){var e=this;return Object(x.jsx)("div",{className:"col-md-12 login",children:Object(x.jsxs)("div",{className:"card card-container",children:[Object(x.jsx)("img",{src:"//ssl.gstatic.com/accounts/ui/avatar_2x.png",alt:"profile-img",className:"profile-img-card"}),Object(x.jsxs)(oe.a,{onSubmit:this.handleLogin,ref:function(t){e.form=t},children:[Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"email",children:"Email"}),Object(x.jsx)(ce.a,{type:"email",className:"form-control",name:"email",value:this.state.email,onChange:this.onChangeEmail,validations:[ke,Ne]})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"password",children:"Password"}),Object(x.jsx)(ce.a,{type:"password",className:"form-control",name:"password",value:this.state.password,onChange:this.onChangePassword,validations:[ke]})]}),Object(x.jsx)("div",{className:"form-group",children:Object(x.jsxs)("button",{className:"btn btn-primary btn-block",disabled:this.state.loading,children:[this.state.loading&&Object(x.jsx)("span",{className:"spinner-border spinner-border-sm"}),Object(x.jsx)("span",{children:"Login"})]})}),this.state.message&&Object(x.jsx)("div",{className:"form-group",children:Object(x.jsx)("div",{className:"alert alert-danger",role:"alert",children:this.state.message})}),Object(x.jsx)(le.a,{style:{display:"none"},ref:function(t){e.checkBtn=t}})]}),Object(x.jsx)("a",{href:"./reset-password",children:"Password reset"})]})})}}]),n}(a.Component),Le=function(e){if(!e)return Object(x.jsx)("div",{className:"alert alert-danger",role:"alert",children:"This field is required!"})},_e=function(e){if(e.length<6||e.length>40)return Object(x.jsx)("div",{className:"alert alert-danger",role:"alert",children:"The password must be between 6 and 40 characters."})},Se=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).resetPassword=a.resetPassword.bind(Object(d.a)(a)),a.onChangePassword=a.onChangePassword.bind(Object(d.a)(a)),a.state={email:"",password:"",token:"",id:0,loading:!0,message:"",success:!1},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;console.log(this.props.match.params),void 0===this.props.match?this.setState({loading:!1,message:"No valid token found."}):f.checkToken(this.props.match.params.id,this.props.match.params.token).then((function(t){console.log(t),e.setState({loading:!1,message:t.message,token:e.props.match.params.token,id:e.props.match.params.id,success:t.success})}))}},{key:"onChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"resetPassword",value:function(e){var t=this;e.preventDefault(),this.setState({message:"",loading:!0}),this.form.validateAll(),0===this.checkBtn.context._errors.length?f.resetPassword(this.state.email,this.state.token,this.state.id,this.state.password).then((function(e){console.log(e),t.setState({loading:!1,message:e.message,success:e.success})}),(function(e){var n=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();t.setState({loading:!1,message:n})})):this.setState({loading:!1})}},{key:"render",value:function(){var e=this;return Object(x.jsx)("div",{className:"col-md-12 login",children:Object(x.jsxs)("div",{className:"card card-container",children:[Object(x.jsx)("img",{src:"//ssl.gstatic.com/accounts/ui/avatar_2x.png",alt:"profile-img",className:"profile-img-card"}),Object(x.jsxs)(oe.a,{onSubmit:this.resetPassword,ref:function(t){e.form=t},children:[this.state.message&&Object(x.jsx)("div",{className:"form-group",children:Object(x.jsx)("div",{className:this.state.success?"alert alert-success":"alert alert-danger",role:"alert",children:this.state.message})}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"password",children:"Password"}),Object(x.jsx)(ce.a,{type:"password",className:"form-control",name:"password",value:this.state.password,onChange:this.onChangePassword,validations:[Le,_e]})]}),Object(x.jsx)("div",{className:"form-group",children:Object(x.jsxs)("button",{className:"btn btn-primary btn-block",disabled:this.state.loading,children:[this.state.loading&&Object(x.jsx)("span",{className:"spinner-border spinner-border-sm"}),Object(x.jsx)("span",{children:"Set new password"})]})}),Object(x.jsx)(le.a,{style:{display:"none"},ref:function(t){e.checkBtn=t}})]})]})})}}]),n}(a.Component),Ue=function(e){if(!e)return Object(x.jsx)("div",{className:"alert alert-danger",role:"alert",children:"This field is required!"})},Ie=function(e){if(!Object(de.isEmail)(e))return Object(x.jsx)("div",{className:"alert alert-danger",role:"alert",children:"This is not a valid email."})},Ae=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).requestToken=a.requestToken.bind(Object(d.a)(a)),a.onChangeEmail=a.onChangeEmail.bind(Object(d.a)(a)),a.state={email:"",loading:!1,message:""},a}return Object(l.a)(n,[{key:"onChangeEmail",value:function(e){this.setState({email:e.target.value})}},{key:"requestToken",value:function(e){var t=this;e.preventDefault(),this.setState({message:"",loading:!0}),this.form.validateAll(),0===this.checkBtn.context._errors.length?f.requestToken(this.state.email).then((function(e){console.log(e),t.setState({loading:!1,message:e.message})}),(function(e){var n=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();t.setState({loading:!1,message:n})})):this.setState({loading:!1})}},{key:"render",value:function(){var e=this;return Object(x.jsx)("div",{className:"col-md-12 login",children:Object(x.jsxs)("div",{className:"card card-container",children:[Object(x.jsx)("img",{src:"//ssl.gstatic.com/accounts/ui/avatar_2x.png",alt:"profile-img",className:"profile-img-card"}),Object(x.jsxs)(oe.a,{onSubmit:this.requestToken,ref:function(t){e.form=t},children:[Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"email",children:"Email"}),Object(x.jsx)(ce.a,{type:"email",className:"form-control",name:"email",value:this.state.email,onChange:this.onChangeEmail,validations:[Ue,Ie]})]}),Object(x.jsx)("div",{className:"form-group",children:Object(x.jsxs)("button",{className:"btn btn-primary btn-block",disabled:this.state.loading,children:[this.state.loading&&Object(x.jsx)("span",{className:"spinner-border spinner-border-sm"}),Object(x.jsx)("span",{children:"Reset password"})]})}),this.state.message&&Object(x.jsx)("div",{className:"form-group",children:Object(x.jsx)("div",{className:"alert",role:"alert",children:this.state.message})}),Object(x.jsx)(le.a,{style:{display:"none"},ref:function(t){e.checkBtn=t}})]})]})})}}]),n}(a.Component),Re=n(155),Te=n.n(Re),Fe=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).getLocations=a.getLocations.bind(Object(d.a)(a)),a.getOptions=a.getOptions.bind(Object(d.a)(a)),a.state={content:"",locations:[],options:{}},a}return Object(l.a)(n,[{key:"getLocations",value:function(){var e=this;O.getPublished().then((function(t){var n=t.data;n.map((function(e){if(e.lead_image){var t=e.images.find((function(t){return t.id==e.lead_image}));e.image_url=t.url}else e.image_url="./img/save-public-housing.jpg"})),e.setState({locations:n})})).catch((function(e){console.log(e)}))}},{key:"getOptions",value:function(){var e=this;q.get(1).then((function(t){e.setState({options:t.data})})).catch((function(e){console.log(e)}))}},{key:"componentDidMount",value:function(){this.getLocations(),this.getOptions()}},{key:"render",value:function(){return Object(x.jsxs)("div",{className:"container",children:[Object(x.jsxs)("div",{className:"row home-intro",children:[Object(x.jsx)("div",{className:"col-md-6",children:this.state.options&&Object(x.jsxs)("header",{children:[Object(x.jsx)("h1",{children:this.state.options.home_heading}),Object(x.jsx)("div",{dangerouslySetInnerHTML:{__html:this.state.options.home_text}})]})}),Object(x.jsxs)("div",{className:"col-md-5 offset-md-1",children:[this.state.options.call_to_action_link&&Object(x.jsxs)("div",{className:"call-to-action",children:[this.state.options.call_to_action_text&&Object(x.jsx)("p",{children:this.state.options.call_to_action_text}),Object(x.jsx)("p",{className:"call-to-action-button",children:Object(x.jsx)("a",{target:"_blank",className:"btn btn-lg btn-action",href:this.state.options.call_to_action_link,children:this.state.options.call_to_action_button||"Take action now"})})]}),this.state.locations.length>0&&Object(x.jsx)(Te.a,{className:"carousel",elementType:"div",options:{wrapAround:!0,pageDots:!1},disableImagesLoaded:!1,reloadOnUpdate:!0,static:!0,children:this.state.locations.map((function(e,t){return Object(x.jsx)("a",{href:"https://map.savepublichousing.com/locations/"+e.slug,className:"location-slide",children:Object(x.jsxs)("div",{className:"card",children:[e.image_url&&Object(x.jsx)("img",{className:"card-img-top",src:e.image_url}),Object(x.jsx)("h4",{className:"card-footer",children:e.title})]})},e.id)}))})]})]}),Object(x.jsx)("div",{className:"map-wrap",children:Object(x.jsx)(K,{zoom:"6",lat:"-36.5",lng:"145.3"})})]})}}]),n}(a.Component),De=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={currentUser:f.getCurrentUser()},a}return Object(l.a)(n,[{key:"render",value:function(){var e=this.state.currentUser;return Object(x.jsx)("div",{className:"container",children:Object(x.jsx)(fe,{id:e.id})})}}]),n}(a.Component),Me=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).getCategories=a.getCategories.bind(Object(d.a)(a)),a.onChangeName=a.onChangeName.bind(Object(d.a)(a)),a.onChangeColor=a.onChangeColor.bind(Object(d.a)(a)),a.onRemove=a.onRemove.bind(Object(d.a)(a)),a.onUpdate=a.onUpdate.bind(Object(d.a)(a)),a.onChangeNewName=a.onChangeNewName.bind(Object(d.a)(a)),a.onChangeNewColor=a.onChangeNewColor.bind(Object(d.a)(a)),a.onCreate=a.onCreate.bind(Object(d.a)(a)),a.state={categories:[],newCategory:{name:"",color:""}},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.getCategories()}},{key:"componentDidUpdate",value:function(e,t,n){this.props.location!==e.location&&this.getResidents(this.props.location)}},{key:"getCategories",value:function(e){var t=this;N.getAll().then((function(n){console.log(n.data),t.setState({categories:n.data}),"function"===typeof e&&e()})).catch((function(e){console.log(e)}))}},{key:"onChangeName",value:function(e,t){var n=this.state.categories.map((function(n){return n.id===e?Object(C.a)(Object(C.a)({},n),{},{name:t.target.value}):n}));this.setState({categories:n})}},{key:"onChangeColor",value:function(e,t){var n=this.state.categories.map((function(n){return n.id===e?Object(C.a)(Object(C.a)({},n),{},{color:t.target.value}):n}));this.setState({categories:n})}},{key:"onRemove",value:function(e){var t=this;window.confirm("Are you sure you want to delete this category?")&&N.delete(e).then((function(e){t.getCategories()})).catch((function(e){console.log(e)}))}},{key:"onUpdate",value:function(e,t){var n=this;e.preventDefault();var a=this.state.categories.find((function(e){return e.id===t}));N.update(t,a).then((function(e){n.getCategories((function(){var e=n.state.categories.map((function(e){return e.id===t?Object(C.a)(Object(C.a)({},e),{},{status:"Updated successfully"}):e}));e.sort((function(e,t){return parseInt(e.id)>parseInt(t.id)?1:-1})),n.setState({categories:e}),console.log("state"),console.log(n.state.categories)}))})).catch((function(e){console.log(e);var a=n.state.categories.map((function(e){return e.id===t?Object(C.a)(Object(C.a)({},e),{},{status:"Update unsuccessful"}):e}));n.setState({categories:a})}))}},{key:"onChangeNewName",value:function(e){this.setState((function(t){return{newCategory:Object(C.a)(Object(C.a)({},t.newCategory),{},{name:e.target.value})}}))}},{key:"onChangeNewColor",value:function(e){this.setState((function(t){return{newCategory:Object(C.a)(Object(C.a)({},t.newCategory),{},{color:e.target.value})}}))}},{key:"onCreate",value:function(){var e=this,t={name:this.state.newCategory.name,color:this.state.newCategory.color};N.create(t).then((function(t){e.setState({newCategory:{name:"",color:""}}),e.getCategories()})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this;return Object(x.jsxs)("div",{className:"location-library",children:[Object(x.jsx)("h2",{children:"Categories"}),Object(x.jsx)("ul",{children:this.state.categories&&this.state.categories.length>0&&this.state.categories.map((function(t){return Object(x.jsx)("li",{children:Object(x.jsxs)("div",{className:"card",children:[Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("label",{htmlFor:"name-"+t.id,children:"Name"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"name-"+t.id,value:t.name||"",onChange:function(n){return e.onChangeName(t.id,n)}}),Object(x.jsx)("label",{htmlFor:"color-"+t.id,children:"Colour"}),Object(x.jsx)("p",{className:"small",children:"Hexcode, e.g. #ff0000"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"color-"+t.id,value:t.color||"",onChange:function(n){return e.onChangeColor(t.id,n)}})]}),Object(x.jsxs)("div",{className:"card-footer",children:[Object(x.jsx)("button",{type:"button",onClick:function(n){return e.onUpdate(n,t.id)},className:"btn btn-success",children:"Update"}),Object(x.jsx)("button",{type:"button",onClick:function(){return e.onRemove(t.id)},className:"btn btn-danger",children:"Remove"}),Object(x.jsx)("div",{className:"status",children:t.status})]})]})},t.id)}))}),Object(x.jsx)("div",{className:"card",children:Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("h4",{className:"card-title",children:"Add new category"}),Object(x.jsx)("label",{htmlFor:"new-name",children:"Name"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"new-name",value:this.state.newCategory.name,onChange:this.onChangeNewName,required:!0}),Object(x.jsx)("label",{htmlFor:"new-color",children:"Colour"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"new-color",value:this.state.newCategory.color,onChange:this.onChangeNewColor,required:!0}),Object(x.jsx)("button",{type:"button",value:"Upload",onClick:this.onCreate,className:"btn btn-primary",children:"Add category"})]})})]})}}]),n}(a.Component),Pe=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).getOptions=a.getOptions.bind(Object(d.a)(a)),a.onChangeTextField=a.onChangeTextField.bind(Object(d.a)(a)),a.onChangeHomeText=a.onChangeHomeText.bind(Object(d.a)(a)),a.onUpdate=a.onUpdate.bind(Object(d.a)(a)),a.state={options:{home_heading:"",home_text:"",call_to_action_text:"",call_to_action_button:"",call_to_action_link:""},message:"",messageClass:""},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.getOptions()}},{key:"getOptions",value:function(e){var t=this;q.get(1).then((function(n){t.setState({options:n.data}),"function"===typeof e&&e()})).catch((function(e){console.log(e)}))}},{key:"onUpdate",value:function(e){var t=this;e.preventDefault(),this.setState({messageClass:"loading"}),q.update(1,this.state.options).then((function(e){return t.setState({message:"Options updated successfully",messageClass:"success"})})).catch((function(e){console.log(e),t.setState({message:"Unable to update options.",messageClass:"danger"})}))}},{key:"onChangeTextField",value:function(e,t){this.setState((function(n){var a=n.options;return a[t]=e.target.value,a}))}},{key:"onChangeHomeText",value:function(e){this.setState((function(t){return{options:Object(C.a)(Object(C.a)({},t.options),{},{home_text:e})}}))}},{key:"render",value:function(){var e=this;return Object(x.jsxs)("div",{children:[Object(x.jsx)("h2",{children:"Options"}),Object(x.jsx)("div",{className:"card",children:Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("label",{htmlFor:"home_heading",children:"Home heading"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"home_heading",value:this.state.options.home_heading||"",onChange:function(t){e.onChangeTextField(t,"home_heading")},required:!0}),Object(x.jsx)("label",{htmlFor:"home_text",children:"Home text"}),Object(x.jsx)(U,{"data-lpignore":"true",id:"home_text",content:this.state.options.home_text||"",onChange:this.onChangeHomeText}),Object(x.jsx)("label",{htmlFor:"call_to_action_text",children:"Call to action text"}),Object(x.jsx)("textarea",{className:"form-control",id:"call_to_action_text",value:this.state.options.call_to_action_text||"",onChange:function(t){e.onChangeTextField(t,"call_to_action_text")},required:!0}),Object(x.jsx)("label",{htmlFor:"call_to_action_link",children:"Call to action link"}),Object(x.jsx)("input",{type:"url",className:"form-control",id:"call_to_action_link",value:this.state.options.call_to_action_link||"",onChange:function(t){e.onChangeTextField(t,"call_to_action_link")},required:!0}),Object(x.jsx)("label",{htmlFor:"call_to_action_button",children:"Call to action button text"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"call_to_action_button",value:this.state.options.call_to_action_button||"",onChange:function(t){e.onChangeTextField(t,"call_to_action_button")},required:!0}),Object(x.jsx)("br",{}),Object(x.jsx)("button",{type:"button",value:"Upload",onClick:this.onUpdate,className:"btn btn-primary",children:"Update"}),Object(x.jsx)("br",{}),Object(x.jsx)("br",{}),Object(x.jsx)("p",{className:"alert alert-"+this.state.messageClass,children:this.state.message}),"loading"==this.state.messageClass&&Object(x.jsx)("div",{className:"spinner-border text-secondary",role:"status",children:Object(x.jsx)("span",{className:"sr-only",children:"Loading..."})})]})})]})}}]),n}(a.Component),Ee=n(156),Be=n(47),He=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).logOut=a.logOut.bind(Object(d.a)(a)),a.state={authCheckComplete:!1,isLoggedIn:!1,isMod:!1,isAdmin:!1,currentUser:void 0},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=f.getCurrentUser();console.log("user"),console.log(e),e&&this.setState({currentUser:e,isLoggedIn:!!e,isMod:e.roles.includes("ROLE_MODERATOR"),isAdmin:e.roles.includes("ROLE_ADMIN")}),this.setState({authCheckComplete:!0})}},{key:"logOut",value:function(){f.logout()}},{key:"render",value:function(){var e=this.state,t=e.currentUser,n=e.isLoggedIn,a=(e.isMod,e.isAdmin),s=e.authCheckComplete;return Object(x.jsxs)("div",{children:[Object(x.jsx)("nav",{id:"nav",className:"navbar navbar-expand navbar-light bg-dark",children:Object(x.jsxs)("div",{className:"d-md-flex justify-content-between",children:[Object(x.jsxs)("div",{className:"flex-item  navbar-nav order-md-1",children:[t&&Object(x.jsxs)(Ee.a,{title:"Manage",menuAlign:"left",id:"manage-menu",children:[Object(x.jsx)(Be.a.Item,{as:"button",children:Object(x.jsx)(c.b,{to:"/admin/locations",className:"nav-link",children:"Locations"})}),Object(x.jsx)(Be.a.Item,{as:"button",children:Object(x.jsx)(c.b,{to:"/admin/locations/add",className:"nav-link",children:"Add New Location"})}),a&&Object(x.jsxs)("div",{children:[Object(x.jsx)(Be.a.Item,{as:"button",children:Object(x.jsx)(c.b,{to:"/admin/users",className:"nav-link",children:"Users"})}),Object(x.jsx)(Be.a.Item,{as:"button",children:Object(x.jsx)(c.b,{to:"/admin/users/add",className:"nav-link",children:"Add New User"})}),Object(x.jsx)(Be.a.Item,{as:"button",children:Object(x.jsx)(c.b,{to:"/admin/categories",className:"nav-link",children:"Categories"})}),Object(x.jsx)(Be.a.Item,{as:"button",children:Object(x.jsx)(c.b,{to:"/admin/options",className:"nav-link",children:"Options"})})]}),Object(x.jsx)(Be.a.Item,{as:"button",children:Object(x.jsx)(c.b,{to:"/profile",className:"nav-link",children:"My profile"})})]}),t?Object(x.jsx)("div",{className:"nav-item",children:Object(x.jsx)("a",{href:"/login",className:"btn btn-action",onClick:this.logOut,children:"Log out"})}):Object(x.jsx)("div",{className:"nav-item d-none d-md-block",children:Object(x.jsx)(c.b,{to:"/login",className:"btn btn-action",children:"Log in"})})]}),Object(x.jsxs)("div",{className:"flex-item  logo order-md-0",children:[Object(x.jsx)("a",{href:"/",className:"navbar-brand",children:Object(x.jsx)("img",{id:"logo",src:"/img/sphc-logo.png"})}),Object(x.jsxs)("a",{href:"/",className:"navbar-brand navbar-brand-text",children:[Object(x.jsx)("span",{className:"small",children:"Save Public Housing Collective"}),Object(x.jsx)("br",{}),"Public Housing Watch Victoria"]})]})]})}),Object(x.jsx)("div",{id:"main",className:"container mt-3",children:Object(x.jsxs)(b.d,{children:[Object(x.jsx)(b.b,{exact:!0,path:["/","/home"],component:Fe}),Object(x.jsx)(b.b,{exact:!0,path:["/map"],component:K}),Object(x.jsx)(Ce,{auth:n,authCheckComplete:s,exact:!0,path:["/admin/locations"],component:H}),Object(x.jsx)(Ce,{auth:n,authCheckComplete:s,path:["/admin/locations/add"],component:y}),Object(x.jsx)(Ce,{auth:n,authCheckComplete:s,path:["/admin/locations/:id"],component:B}),Object(x.jsx)(b.b,{path:["/locations/:slug"],component:ae}),Object(x.jsx)(Ce,{auth:a,authCheckComplete:s,exact:!0,path:["/admin/users"],component:xe}),Object(x.jsx)(Ce,{auth:a,authCheckComplete:s,path:["/admin/users/add"],component:ge}),Object(x.jsx)(Ce,{auth:a,authCheckComplete:s,path:["/admin/users/:id"],component:fe}),Object(x.jsx)(Ce,{auth:a,authCheckComplete:s,path:["/admin/categories"],component:Me}),Object(x.jsx)(Ce,{auth:a,authCheckComplete:s,path:["/admin/options"],component:Pe}),Object(x.jsx)(Ce,{auth:n,authCheckComplete:s,exact:!0,path:["/profile"],component:De}),Object(x.jsx)(b.b,{exact:!0,path:"/login",component:we}),Object(x.jsx)(b.b,{exact:!0,path:"/reset-password",component:Ae}),Object(x.jsx)(b.b,{path:"/reset-password/:id/:token",component:Se})]})}),Object(x.jsx)("div",{id:"footer",children:Object(x.jsx)("div",{className:"container",children:Object(x.jsxs)("div",{className:"row",children:[Object(x.jsxs)("div",{className:"col-sm-7",children:[Object(x.jsx)("h5",{children:"Save Public Housing Collective"}),Object(x.jsx)("p",{children:"We are a grassroots collective made up of local public housing estate residents and resident groups, neighbourhood friends of public housing, activist and advocacy groups, churches, legal professionals, academics and researchers. We fight against the state-led abandonment of the human right to housing and the forced displacement of public housing residents through renewal programs. We fight together for the protection of public housing residents\u2019 rights to dwell in safe, secure and affordable homes and places."}),!t&&Object(x.jsx)("div",{className:"d-block d-md-none",children:Object(x.jsx)(c.b,{to:"/login",className:"btn btn-action",children:"Log in"})})]}),Object(x.jsxs)("div",{className:"col-sm-4 offset-sm-1",children:[Object(x.jsx)("h5",{children:"Connect with us"}),Object(x.jsx)("a",{target:"_blank",href:"https://www.savepublichousing.com/",children:"Website"}),Object(x.jsx)("br",{}),Object(x.jsx)("a",{target:"_blank",href:"https://twitter.com/savepublichous",children:"Twitter"}),Object(x.jsx)("br",{}),Object(x.jsx)("a",{target:"_blank",href:"https://www.facebook.com/savepublichousingcollective",children:"Facebook"}),Object(x.jsx)("br",{}),Object(x.jsx)("a",{target:"_blank",href:"https://www.instagram.com/savepublichousingcollective/",children:"Instagram"}),Object(x.jsx)("h5",{children:"Allies"}),Object(x.jsx)("a",{target:"_blank",href:"https://rahu.org.au/",children:"Renters & Housing Union"})]})]})})})]})}}]),n}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(x.jsx)(c.a,{children:Object(x.jsx)(He,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[321,1,2]]]);
//# sourceMappingURL=main.af899fb9.chunk.js.map